function isMobile(){const e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series([46])0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br([ev])w|bumb|bw-([nu])|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do([cp])o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly([-_])|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-([mpt])|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c([- _agpst])|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac([ \-\/])|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja([tv])a|jbro|jemu|jigs|kddi|keji|kgt([ \/])|klon|kpt |kwc-|kyo([ck])|le(no|xi)|lg( g|\/([klu])|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t([- ov])|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30([02])|n50([025])|n7(0([01])|10)|ne(([cm])-|on|tf|wf|wg|wt)|nok([6i])|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan([adt])|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c([-01])|47|mc|nd|ri)|sgh-|shar|sie([-m])|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel([im])|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c([- ])|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(e.substr(0,4))}!function(e){"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(window.jQuery)}(function(e){function a(e,a,t){var n=t[e];return void 0===n?t[e]=[a]:n.push(a),t}var t={checked:["radio","checkbox"],selected:["option","select-one","select-multiple"],value:["button","color","date","datetime","datetime-local","email","hidden","month","number","password","range","reset","search","submit","tel","text","textarea","time","url","week"]};function n(a,n,r,s,o){var l=function(a){var n=function(e){return(e.type||e.nodeName).toLowerCase()}(a),r=void 0;return e.each(t,function(a,t){if(e.inArray(n,t)>-1)return r=a,!1}),r}(a);if("value"==l&&n==s)a.value=r,o.call(a,r);else if("checked"==l||"selected"==l){var i=[];a.options?e.each(a.options,function(e,a){i.push(a)}):i.push(a),a.multiple&&0==s&&(a.selectedIndex=-1),e.each(i,function(e,a){a.value==r&&(a[l]=!0,o.call(a,r))})}}var r={change:e.noop,complete:e.noop};e.fn.deserialize=function(t,s){e.isFunction(s)&&(s={complete:s}),s=e.extend(r,s||{}),t=function(t){var n={},r=/\+/g;return e.isPlainObject(t)?(e.extend(n,t),e.each(n,function(a,t){e.isArray(t)||(n[a]=[t])})):e.isArray(t)?e.each(t,function(e,t){a(t.name,t.value,n)}):"string"==typeof t&&e.each(t.split("&"),function(e,t){var s=t.split("=");a(decodeURIComponent(s[0].replace(r,"%20")),decodeURIComponent(s[1].replace(r,"%20")),n)}),n}(t);var o=function(t,n){var r={},s=t.map(function(){return this.elements?e.makeArray(this.elements):this}).filter(n||":input:not(:disabled)").get();return e.each(s,function(e,t){a(t.name,t,r)}),r}(this,s.filter);return e.each(t,function(a,t){e.each(o[a],function(a,r){e.each(t,function(e,t){n(r,a,t,e,s.change)})})}),s.complete.call(this),this}});const defaultChartOptions={chart:{type:"spline",backgroundColor:"rgba(0,0,0,0)",spacing:[4,0,0,0]},title:{text:""},subtitle:{text:""},credits:{enabled:!1},xAxis:{title:{text:""},type:"datetime"},legend:{enabled:!0,itemStyle:{color:"#28a745"},itemHiddenStyle:{color:"#666666"}},plotOptions:{series:{marker:{enabled:!1}}},colors:["#28a745","#7cb5ec","#f15c80","#f7a35c","#8085e9","#434348","#e4d354","#2b908f","#f45b5b","#91e8e1"]};function plotline(e,a){return(e=parseInt(e)).toString().length>=10&&(e*=1e3),[{value:e,color:"red",width:1,zIndex:3,label:{formatter:function(){return a},style:{color:darkMode?"#e9ecef":"#000000"}}}]}function highLightOwnedGames(e){if(e||(e=$("body")),user.isLoggedIn){let a=localStorage.getItem("gamedb-games");null!=a&&null!=(a=JSON.parse(a))&&e.find("[data-app-id]").each(function(){const e=$(this).attr("data-app-id");-1!==a.indexOf(parseInt(e))&&$(this).addClass("font-weight-bold")});let t=localStorage.getItem("gamedb-groups");null!=t&&null!=(t=JSON.parse(t))&&e.find("[data-group-id]").each(function(){const e=$(this).attr("data-group-id");-1!==t.indexOf(e)&&$(this).addClass("font-weight-bold")});let n=localStorage.getItem("gamedb-badges");null!=n&&null!=(n=JSON.parse(n))&&e.find("[data-badge-id]").each(function(){const e=$(this).attr("data-badge-id");-1!==n.indexOf(parseInt(e))&&$(this).addClass("font-weight-bold")})}}function isIterable(e){return null!=e&&"function"==typeof e[Symbol.iterator]}function isNumeric(e){return!isNaN(parseFloat(e))&&isFinite(e)}function isJson(e){try{JSON.parse(e)}catch(e){return!1}return!0}function logLocal(){user.log&&console.log(...arguments)}function setUrlParam(e,a){const t=new URL(window.location);if(Array.isArray(a)){t.searchParams.delete(e);for(const n of a)t.searchParams.append(e,n)}else t.searchParams.set(e,a);t.searchParams.sort(),window.history.replaceState(null,null,t.pathname+t.search+t.hash)}function deleteUrlParam(e){const a=new URL(window.location);a.searchParams.delete(e),window.history.replaceState(null,null,a.pathname+a.search+a.hash)}function clearUrlParams(){window.history.replaceState(null,null,window.location.pathname+window.location.hash)}function ordinal(e){let a=e%10,t=e%100;return 1===a&&11!==t?e.toLocaleString()+"st":2===a&&12!==t?e.toLocaleString()+"nd":3===a&&13!==t?e.toLocaleString()+"rd":e.toLocaleString()+"th"}function pad(e,a,t){return t=t||"0",(e+="").length>=a?e:new Array(a-e.length+1).join(t)+e}function serialiseTable(e,a){const t={};return $(e).each(function(e,a){const n=a.attr("name")?a.attr("name"):a.attr("data-name");t[n]=a.val()}),t.order=a,t}function pauseAllVideos(){$("video").each(function(e){$(this)[0].pause()})}function handleVideos(){$("#media video").on("click",function(e){const a=$(this)[0];a.paused?(pauseAllVideos(),a.play()):a.pause()})}function observeLazyImages(e){if(!e)return;"string"!=typeof e&&"object"!=typeof e||(e=$(e));let a=new IntersectionObserver(function(e,a){e.forEach(e=>{e.isIntersecting&&(loadImage($(e.target)),a.unobserve(e.target))})},{rootMargin:"0px 0px 50px 0px",threshold:0});e.each(function(e){a.observe(this)})}function observeLazyVideos(){let e=new IntersectionObserver(function(e,a){e.forEach(e=>{e.isIntersecting&&(loadVideo($(e.target)),a.unobserve(e.target))})},{rootMargin:"0px 0px 50px 0px",threshold:0});$("video").each(function(a){e.observe(this)})}function loadVideo(e){e.attr("preload","metadata")}function loadImage(e){const a=e.attr("data-lazy-alt");a&&e.attr("alt",a);const t=e.attr("data-lazy-title");t&&e.attr("title",t);const n=e.attr("data-lazy");n&&e.attr("src",n),e.removeAttr("data-lazy-alt"),e.removeAttr("data-lazy-title"),e.removeAttr("data-lazy"),e.attr("data-observed",1)}function fixBrokenImages(){$("img").one("error",function(){const e=$(this).attr("data-src");this.src=e||"/assets/img/no-app-image-square.jpg"}),$('img[src=""][data-src]').each(function(e,a){this.src=$(this).attr("data-src")})}function _numbers(e,a){let t;const n=Math.floor(4.5);return a<=9?t=_range(0,a):e<=n?(t=_range(0,7)).push("ellipsis"):e>=a-1-n?((t=_range(a-7,a)).splice(0,0,"ellipsis"),t.splice(0,0,0)):((t=_range(e-n+2,e+n-1)).push("ellipsis"),t.splice(0,0,"ellipsis"),t.splice(0,0,0)),t.DT_el="span",t}function _range(e,a){const t=[];let n;n=a;for(let r=a=e;r<n;r++)t.push(r);return t}function toast(e,a,t="",n=0,r=""){0===n?n=5:n<0&&(n=0);const s={onclick:r?function(){"refresh"===r&&location.reload()}:null,newestOnTop:!1,preventDuplicates:!1,progressBar:!0,timeOut:1e3*n,extendedTimeOut:1e3*n};return isMobile()?(s.positionClass="toast-bottom-right",s.newestOnTop=!0):s.positionClass="toast-top-right",e?toastr.success(a,t,s):toastr.error(a,t,s)}let _websocket;function websocketListener(e,a,t=1){if(void 0===window.WebSocket)return void(user.log&&log.console("Your browser does not support websockets"));if(_websocket&&_websocket.readyState===WebSocket.OPEN)return void logLocal("Websocket already open");_websocket=new WebSocket(("https:"===location.protocol?"wss://"+window.location.hostname:"ws://"+location.host)+"/websocket/"+e);let n=$("#live-badge");_websocket.onopen=function(e){logLocal("websocket opened"),n.addClass("badge-success cursor-pointer"),n.removeClass("badge-secondary badge-danger"),t=1},_websocket.onclose=function(e){logLocal("Websocket closed",e),r(n,t,e,"onclose")},_websocket.onerror=function(e){logLocal("Websocket error",e),r(n,t,e,"onerror")},_websocket.onmessage=function(e){return logLocal("WS: "+e.data),a(e)},1===t&&n.on("click",function(t){$(this).hasClass("badge-danger")?(logLocal("Websocket opened manually"),websocketListener(e,a,2),n.addClass("badge-success"),n.removeClass("badge-secondary badge-danger")):$(this).hasClass("badge-success")&&(logLocal("Websocket closed manually",t),null!==_websocket&&_websocket.close(1e3),t.code=1e3,r(n,1,t,"manual"))});const r=function(t,n,r,s){logLocal(s,n),_websocket=null,t.addClass("badge-danger"),t.removeClass("badge-secondary badge-success"),"onclose"!==s&&"manual"!==s||1e3!==r.code&&setTimeout(function(){websocketListener(e,a,n+1)},5e3)}}$(function(){fixBrokenImages(),handleVideos(),observeLazyImages("img[data-lazy]"),observeLazyVideos()}),$.fn.dataTableExt.oPagination.gamedb=function(e,a){return["previous",_numbers(e,a),"next"]},function(e,a,t,n){"use strict";const r={cache:!0,searchFields:[],tableOptions:{autoWidth:!1,buttons:["csv"],dom:'<"dt-header"<"dt-pagination"p><"dt-info"iB>>t<"dt-footer"<"dt-pagination"p>>r',fixedHeader:!0,info:!0,processing:!1,language:{processing:'<i class="fas fa-spinner fa-spin fa-3x fa-fw"></i>',paginate:{next:'<i class="fas fa-chevron-right"></i>',previous:'<i class="fas fa-chevron-left"></i>'},info:"_TOTAL_ rows",infoFiltered:" of _MAX_"},lengthChange:!1,ordering:!0,pageLength:100,paging:!0,pagingType:"gamedb",searching:!0,stateSave:!1,search:{smart:!0}}};function s(t,s){const d=e(t);s=e.extend(!0,{},r,s),d.hasClass("table-counts")||(s.tableOptions.dom=s.tableOptions.dom.replace('<"dt-info"iB>',"")),s.isAjax=function(){return null!=d.attr("data-path")};const u=d.attr("data-row-type");u&&(s.tableOptions.language.info="_TOTAL_ "+u+" (_PAGES_ pages)");let p={},m={};if(s.isAjax())s=e.extend(!0,{},s,{tableOptions:{processing:!1,serverSide:!1!==s.tableOptions.serverSide,orderMulti:!1,ajax:function(a,t,n){delete a.columns,a.search=m,e.ajax({data:a,dataType:"json",cache:s.cache,url:d.attr("data-path"),success:t,error:function(e,n,r){t(a={draw:"1",recordsTotal:"0",recordsFiltered:"0",data:[],limited:!1},n,null)}})}}});else{const a=d.find("thead tr th[data-disabled]").map(function(){return e(this).index()}).get();s=e.extend(!0,{},s,{tableOptions:{columnDefs:[{orderable:!1,targets:a}]}});const t=d.attr("data-limit");t&&(s.tableOptions.pageLength=parseInt(t))}for(const e of s.searchFields){const a=i(e),t=o(e);void 0===a&&logLocal("Search field missing name field"),a&&t&&t.length>0&&(p[a]=t,m[a]=t)}const g=new URL(a.location).searchParams;for(const e of s.searchFields){const a=i(e);if(a&&g.has(a)){let t;l(e,t=c(e)?g.getAll(a):g.get(a)),m[a]=t,e.attr("data-hightlight")&&(this.highlight=t);const n=e.attr("data-col-sort");n&&t&&(s.tableOptions.order=[[parseInt(n),"desc"]])}}if(g.has("s")&&g.has("o")){const e=g.get("s"),a=g.get("o");s.tableOptions.order=[[parseInt(e),a]],m.s=e,m.o=a}this.options=s,this.element=t,this.user=n,this.initialValues=p,this.currentValues=m,this.urlParams=g,this.init()}function o(e){return e.hasClass("noUi-target")?e[0].noUiSlider.get():"radio"===e.attr("type")?e.filter(":checked").val():e.val()}function l(e,a){e.hasClass("noUi-target")?e[0].noUiSlider.set(a):"radio"===e.attr("type")?e.filter("[value"+a+"]").prop("checked",!0):(e.val(a),e.hasClass("form-control-chosen")&&e.trigger("chosen:updated"))}function i(e){return e.hasClass("noUi-target")?e.attr("data-name"):e.attr("name")}function c(e){return e.hasClass("noUi-target")?o(e).length>1:!!e.prop("multiple")}e.extend(s.prototype,{init:function(){const t=this;e(this.element).on("preXhr.dt",function(a,n,r){e(t.element).stop(!0,!0).fadeTo(200,.3)}),e(this.element).on("xhr.dt",function(a,n,r,s){e(t.element).stop(!0,!0).fadeTo(200,1),t.limited=r.limited});const n=e(this.element).DataTable(this.options.tableOptions);this.dt=n,this.initialValues.s=e.extend(!0,[],n.order()),e(this.element).on("draw.dt",function(a,r){if(t.limited){const a=e("li.paginate_button.page-item.next.disabled").length>0?"font-weight-bold":"",n=2===t.limited?e('<li class="donate"><small><a href="/login"><i class="fas fa-unlock"></i> <span class="'+a+'">Login for more!</span></a></small></li>'):e('<li class="donate"><small><a href="/donate"><i class="fas fa-heart text-danger"></i> <span class="'+a+'">Donate for more!</span></a></small></li>');e(t.element).parent().find(".dt-pagination ul.pagination").append(n)}const s=e(t.element).parent().find(".dt-header .dt-pagination"),o=e(t.element).parent().find(".dt-footer .dt-pagination");if(n.page.info().pages<=1?(o.hide(),e(t.element).hasClass("table-counts")||s.hide()):(o.show(),s.show()),e.fn.mark){const a=e(".markable");a.unmark(),t.highlight&&a.mark(t.highlight)}highLightOwnedGames(e(t.element)),observeLazyImages(e(t.element).find("img[data-lazy]")),fixBrokenImages()}),e(this.element).on("page.dt",function(a,t,n){let r=15;e(".fixedHeader-floating").length>0&&(r+=48),e("html, body").animate({scrollTop:e(this).prev().offset().top-r},200)}),e('a[data-toggle="tab"]').on("shown.bs.tab",function(t){e.each(a.gdbTables,function(a,t){e(t).DataTable().fixedHeader.adjust()}),e(this).attr("data-keep-query")||clearUrlParams()});let r=setTimeout(null);for(const e of this.options.searchFields){const s=function(a){let s=o(e);const l=e.attr("data-col-sort");l&&(s?(n.order()[0][0]!==parseInt(l)&&(t.sortBeforeSearch=n.order()),n.order([parseInt(l),"desc"])):n.order(t.sortBeforeSearch)),e.attr("data-hightlight")&&(t.highlight=s);const c=i(e);return c&&(t.currentValues[c]=s,setUrlParam(c,s)),e.hasClass("noUi-target")&&updateLabels(),t.options.isAjax()?(clearTimeout(r),r=setTimeout(function(){n.draw()},600),!0):(n.search(o(e)).draw(),!1)};e.hasClass("noUi-target")?(e[0].noUiSlider.on("set",s),e[0].noUiSlider.on("update",function(e){"function"==typeof a.updateLabels&&a.updateLabels()})):e.hasClass("form-control-chosen")?e.on("chosen:updated change",s):e.on("input search",s)}e("div.dt-pagination").on("focus",".paginate_button > a",function(){e(this).trigger("blur")}),this.options.isAjax()||e(t.element).trigger("draw.dt"),a.gdbTables=a.gdbTables||[],a.gdbTables.push(this.element)}}),e.fn.gdbTable=function(e){return new s(this,e).dt},e("table.table.table-datatable").each(function(a){e(this).gdbTable()})}(jQuery,window,document,user);const $document=$(document),$body=$("body");$(document).on("mouseup","[data-link] a, [data-link] .select-checkbox, [data-link-tab] a",function(e){return e.stopPropagation(),!1}),$(".stop-prop").on("click",function(e){e.stopPropagation()});let dataLinkDrag=!1,dataLinkX=0,dataLinkY=0;if($document.on("mousedown","[data-link]",function(e){if(dataLinkX=e.screenX,dataLinkY=e.screenY,dataLinkDrag=!1,1===e.button)return!1}),$document.on("mousemove","[data-link]",function(e){!dataLinkDrag&&(Math.abs(dataLinkX-e.screenX)>5||Math.abs(dataLinkY-e.screenY)>5)&&(dataLinkDrag=!0)}),$(document).on("mouseup","[data-link]",function(e){e.stopPropagation();const a=$(this).attr("data-link"),t=$(this).attr("data-target");return!a||(!!dataLinkDrag||(3===e.which||(1===e.button||e.ctrlKey||e.shiftKey||e.metaKey||2===e.which||"_blank"===t?($(e.target).is("a")||window.open(a,"_blank"),!0):(window.location.href=a,!0))))}),user.isProd){const e="\n _____                       ____________ \n|  __ \\                      |  _  \\ ___ \\\n| |  \\/ __ _ _ __ ___   ___  | | | | |_/ /\n| | __ / _` | '_ ` _ \\ / _ \\ | | | | ___ \\\n| |_\\ \\ (_| | | | | | |  __/ | |/ /| |_/ /\n \\____/\\__,_|_| |_| |_|\\___| |___/ \\____/ \n";console.log(e)}const $dropdowns=$(".navbar .dropdown");$dropdowns.on("mouseenter",function(e){$(this).addClass("show").find(".dropdown-menu").addClass("show")}),$dropdowns.on("mouseleave",function(e){$(this).removeClass("show").find(".dropdown-menu").removeClass("show")}),$dropdowns.on("click",function(e){e.stopPropagation()}),$body.tooltip({selector:'[data-toggle="tooltip"]'}),$(".json").each(function(e,a){const t=$(this).text();if(isJson(t)){const e=JSON.parse(t);$(this).text(JSON.stringify(e,null,"  "))}}),function(e,a){"use strict";e(function(t){const n=a.location.hash;if(n){let a="";n.split(/[,\-]/).forEach(function(t){e('.nav-link[href="'+(a=""===a?t:a+"-"+t)+'"]').tab("show")})}e('a[data-toggle="tab"]:not([data-no-hash-change])').on("shown.bs.tab",function(a){const t=e(a.target).attr("href");history.pushState?history.pushState(null,null,t):location.hash=t})})}(jQuery,window);const $top=$("#top");if($(window).on("scroll",function(e){$(window).scrollTop()>=1e3?$top.addClass("show"):$top.removeClass("show")}),$top.on("click",function(e){$("html, body").animate({scrollTop:0},500)}),isIterable(user.toasts))for(const e of user.toasts)toast(e.success,e.message,e.title,e.timeout,e.link);$(function(e){const a=$("#app-page, #package-page, #player-page, #bundle-page, #group-page, #badge-page, #stat-page").attr("data-path");a&&a!==window.location.pathname&&history.replaceState(null,null,a+window.location.hash)});const $lockIcon='<i class="fa fa-lock text-muted" data-toggle="tooltip" data-placement="left" title="Private"></i>';function addDataTablesRow(e,a,t,n){let r=$('<tr class="fade-green" />');if("function"==typeof e.createdRow&&e.createdRow(r[0],a,null),isIterable(e.columnDefs))for(const t of e.columnDefs){let e=a[t];if("visible"in t&&!1===t.visible)continue;"render"in t&&(e=t.render(null,null,a));const n=$("<td />").html(e);"createdCell"in t&&t.createdCell(n,null,a,null,null),n.find("[data-livestamp]").html("a few seconds ago"),r.append(n)}n.prepend(r),n.find("tbody tr").slice(t).remove(),observeLazyImages(r.find("img[data-lazy]"))}function loadAjaxOnObserve(e){for(const a in e)if(e.hasOwnProperty(a)){const t=e[a],n=document.getElementById(a);if(n){new IntersectionObserver(function(e,a){e.forEach(e=>{e.isIntersecting&&(a.unobserve(e.target),t())})},{rootMargin:"50px 0px 50px 0px",threshold:0}).observe(n)}}}const cookieName="gamedb-session-2";function setCookieFlag(e,a){let t=getSessionCookie();return t[e]=a,Cookies.set(cookieName,JSON.stringify(t),{expires:30,secure:user.isProd})}function getSessionCookie(e=null){let a=Cookies.get(cookieName),t={};return a&&(t=JSON.parse(a)),e?t[e]:t}$(".jumbotron button.close").on("click",function(e){$(this).closest(".jumbotron").slideUp(),setCookieFlag($(this).attr("data-id"),!0)});const $darkMode=$("#dark-mode");$darkMode.on("click",function(e){const a=$darkMode.find(".fa-sun"),t=$darkMode.find(".fa-moon");return a.hasClass("d-none")?(a.removeClass("d-none"),t.addClass("d-none"),$("body").removeClass("dark"),setCookieFlag("dark",!1)):(a.addClass("d-none"),t.removeClass("d-none"),$("body").addClass("dark"),setCookieFlag("dark",!0)),!1});let darkMode=getSessionCookie("dark");function getOS(){let e="windows";return-1!==navigator.appVersion.indexOf("Mac")&&(e="macos"),-1!==navigator.appVersion.indexOf("Linux")&&(e="linux"),e}function loadFriends(e,a,t){$.ajax({type:"GET",url:"/games/"+e+"/friends.json",dataType:"json",success:function(e,n,r){const s=$("select#friend");null===e&&(e=[]),e.sort(function(e,a){return e.v.toLowerCase().localeCompare(a.v.toLowerCase())}),s.empty(),s.append('<option value="">Choose Friend</option>'),a&&user.playerID&&user.playerName&&s.append('<option value="'+user.playerID+'">'+user.playerName+"</option>");for(const a of e)s.append('<option value="'+a.k+'">'+a.v+"</option>");const o=s.chosen({disable_search_threshold:5,allow_single_deselect:!1,max_selected_options:1});o.change(function(e){t(o)})}})}void 0===darkMode&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&$darkMode.trigger("click"),$(document).on("click","#patreon-message i, #patreon-message svg",function(e){return setCookieFlag("patreon-message",!0),$(this).parent().slideUp(300,function(){$("#patreon-message").remove()}),!1}),$("[data-link-tab]").on("mouseup",function(){const e=$(this).attr("data-link-tab");return $('a.nav-link[href="#'+e+'"]').tab("show"),!1}),window.addEventListener("message",e=>{try{let a=JSON.parse(e.data);if("resize-me"===a.msg_type){let e=!1;for(let t in a.key_value)if(a.key_value.hasOwnProperty(t)){let n=a.key_value[t].key,r=a.key_value[t].value;"r_nh"===n&&"0"===r&&(e=!0)}e&&($("#flashes-ad").hide(),logLocal("Ads collapsed"))}}catch(e){}});const $priceChart=$("#app-page #prices-chart, #package-page #prices-chart");if($priceChart.length>0&&prices){let e,a;function upateChart(t){a&&a.abort(),$("tr[data-code]").removeClass("font-weight-bold").attr("data-link",""),$("tr[data-code="+t+"]").addClass("font-weight-bold").removeAttr("data-link"),e.showLoading(),a=$.ajax({type:"GET",data:{code:t},url:$priceChart.attr("data-ajax"),dataType:"json",cache:!0,success:function(a,t,n){"prices"in a&&(e.series[0].setData(a.prices),e.yAxis[0].update({title:{text:"Price ("+a.symbol+")"}}),e.hideLoading())}})}function loadPriceChart(){e=Highcharts.chart("prices-chart",$.extend(!0,{},defaultChartOptions,{legend:{enabled:!1},xAxis:{labels:{step:1,formatter:function(){return moment(this.value).format("Do MMM YY")}}},yAxis:{title:{text:"Price ("+user.userCurrencySymbol+")"},min:0,allowDecimals:!0},series:[{type:"line",name:"Price",step:"left",color:"#28a745"}]})),upateChart(user.prodCC)}$("#prices tr[data-code]").on("click",function(e){$(this).hasClass("font-weight-bold")||upateChart($(this).attr("data-code"))})}if($("#admin-websockets-page").length>0&&setTimeout(function(){window.location.reload(1)},5e3),$("#admin-tasks-page").length>0&&($("#actions tbody td:not(.dataTables_empty)").on("click",function(){return confirm("Are you sure?")&&$.ajax({type:"get",url:$(this).parent().attr("data-action"),error:function(e,a,t){toast(!1,t)}}),!1}),websocketListener("admin",function(e){const a=JSON.parse(e.data),t=a.Data.task_id,n=a.Data.action;if(t&&n){const e=$('tr[data-id="'+t+'"]');"started"===n?(e.addClass("table-warning"),e.removeClass("table-danger")):"finished"===n&&(e.removeClass("table-warning"),e.removeClass("table-danger"),e.find(".prev").livestamp(),e.find(".next").livestamp(new Date(1e3*a.Data.time)),toast(!0,t+" finished","",0))}})),$("#admin-queues-page").length>0){const e=$("form#queues");e.on("submit",function(a){a.preventDefault(),$.ajax({type:"post",url:e.attr("action"),data:$(this).serialize(),success:function(a,t,n){toast(!0,"Queued"),e.trigger("reset")},error:function(e,a,t){toast(!1,t)}})})}if($("#admin-users-page").length>0){const e={order:[[1,"desc"]],columnDefs:[{targets:0,render:function(e,a,t){return t[2]?'<i class="fas fa-check text-success fa-fw"></i> '+t[1]:'<i class="fas fa-times text-danger fa-fw"></i> '+t[1]},orderable:!1},{targets:1,render:function(e,a,t){return t[0]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:2,render:function(e,a,t){return"1970-01-01 00:00:00"===t[5]||"0001-01-01 00:00:00"===t[5]?"":t[5]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:3,render:function(e,a,t){if(t[3]){const e=t[3];let a="";return e.hasOwnProperty("steam")&&(a+='<a class="mr-1" href="/players/'+e.steam+'" target="_blank" rel="noopener"><i class="fab fa-steam"></i></a>'),e.hasOwnProperty("discord")&&(a+='<span class="mr-1"><i class="fab fa-discord"></i></span>'),e.hasOwnProperty("google")&&(a+='<span class="mr-1"><i class="fab fa-google"></i></span>'),e.hasOwnProperty("twitch")&&(a+='<span class="mr-1"><i class="fab fa-twitch"></i></span>'),e.hasOwnProperty("github")&&(a+='<a class="mr-1" href="https://api.github.com/user/'+e.github+'" target="_blank" rel="noopener"><i class="fab fa-github"></i></a>'),e.hasOwnProperty("patreon")&&(a+='<a class="mr-1" href="https://www.patreon.com/user?u='+e.patreon+'" target="_blank" rel="noopener"><i class="fab fa-patreon"></i></a>'),e.hasOwnProperty("twitter")&&(a+='<a class="mr-1" href="https://twitter.com/i/user/'+e.twitter+'" target="_blank" rel="noopener"><i class="fab fa-twitter"></i></a>'),a}return""},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:4,render:function(e,a,t){return t[4]>1?t[4]:""},orderSequence:["desc"]}]};$("table.table").gdbTable({tableOptions:e})}if($("#admin-discord-guilds-page").length>0){const e={order:[[1,"desc"]],columnDefs:[{targets:0,render:function(e,a,t){return'<a class="icon-name"><div class="icon"><img data-lazy="'+t[2]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderSequence:["asc","desc"]},{targets:1,render:function(e,a,t){return t[3].toLocaleString()},orderSequence:["desc","asc"]},{targets:2,render:function(e,a,t){return t[4].toLocaleString()},orderSequence:["desc","asc"]}]};$("table.table").gdbTable({tableOptions:e})}if($("#admin-consumers-page").length>0){const e={order:[[0,"desc"]],drawCallback:function(e){const a=this.api();if(a.order()[0]&&0===a.order()[0][0]){const e=a.rows({page:"current"}).nodes();let t=null;a.rows().every(function(a,n,r){let s=this.data()[6];t!==s&&(s?$(e).eq(a).before('<tr class="table-success"><td colspan="6">Active</td></tr>'):$(e).eq(a).before('<tr class="table-danger"><td colspan="6">Expired</td></tr>'),t=s)})}},columnDefs:[{targets:0,render:function(e,a,t){return t[0]},orderSequence:["desc","asc"]},{targets:1,render:function(e,a,t){return t[1]},orderable:!1},{targets:2,render:function(e,a,t){return t[2]},orderable:!1},{targets:3,render:function(e,a,t){return'<a href="https://github.com/gamedb/gamedb/compare/'+t[3]+'...master" target="_blank" rel="noopener">'+t[3]+"</a>"},orderable:!1},{targets:4,render:function(e,a,t){return t[4]?parseInt(t[4]).toLocaleString():"-"},orderSequence:["desc","asc"]},{targets:5,render:function(e,a,t){return t[5]},orderable:!1}]};$("table.table").gdbTable({tableOptions:e})}if($("#admin-webhooks-page").length>0){$("select.form-control-chosen").chosen({disable_search_threshold:5,allow_single_deselect:!0});const e={order:[[0,"desc"]],createdRow:function(e,a,t){$(e).addClass("cursor-pointer")},columnDefs:[{targets:0,render:function(e,a,t){return t[0]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:1,render:function(e,a,t){return t[1]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:2,render:function(e,a,t){return t[2]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:3,render:function(e,a,t){return t[4]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1}]},a=$("table.table"),t=a.gdbTable({tableOptions:e,searchFields:[$("#service")]});a.on("click","tbody tr[role=row]",function(){const e=t.row($(this));e.child.isShown()?(e.child.hide(),$(this).removeClass("shown")):(e.child("<pre>"+JSON.stringify(JSON.parse(e.data()[3]),null,4)+"</pre>").show(),$(this).addClass("shown"))})}if($("#admin-delays-page").length>0){const e={order:[[0,"desc"]],columnDefs:[{targets:0,render:function(e,a,t){return t[2]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:1,render:function(e,a,t){return t[3]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:2,render:function(e,a,t){return t[4].toLocaleString()},orderSequence:["desc","asc"]},{targets:3,render:function(e,a,t){return t[5].toLocaleString()},orderable:!1}]};$("table.table").gdbTable({tableOptions:e})}const $achievementsPage=$("#achievements-page");if($achievementsPage.length>0){const e={order:[[1,"asc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[7])},columnDefs:[{targets:0,render:function(e,a,t){t[8]&&(t[2]="<em>&lt;Hidden&gt;</em> "+t[2]);let n=t[5]+": "+t[9]+"<br><small>"+t[2]+"</small>";return'<a href="'+t[7]+'" class="icon-name"><div class="icon"><img class="tall" data-lazy="'+t[1]+'" alt="" data-lazy-alt="'+t[0]+'"></div><div class="name">'+n+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[3]+"%"},createdCell:function(e,a,t,n,r){t[3]=Math.ceil(t[3]),$(e).css("background","linear-gradient(to right, rgba(0,0,0,.15) "+t[3]+"%, transparent "+t[3]+"%)"),$(e).addClass("thin")},orderSequence:["desc","asc"]},{targets:2,render:function(e,a,t){return t[6]},orderable:!1,visible:user.isLocal}]},a=[$("#search")];$("table.table").gdbTable({tableOptions:e,searchFields:a})}$("#apps-page").length>0&&function(e,a){"use strict";e("select.form-control-chosen").chosen({disable_search_threshold:5,allow_single_deselect:!0,max_selected_options:10});const t=e("#price-slider"),n=noUiSlider.create(t[0],{start:[0,100],connect:!0,step:1,range:{min:0,max:100},format:{to:e=>parseFloat(e).toFixed(2),from:e=>parseFloat(e).toFixed(2)}}),r=e("#score-slider"),s=noUiSlider.create(r[0],{start:[0,100],connect:!0,step:1,range:{min:0,max:100},format:{to:e=>parseFloat(e).toFixed(0),from:e=>parseFloat(e).toFixed(0)}});function o(a){const t=n.get();t[0]===t[1]?e("label#price-label").html("Price ("+user.userCurrencySymbol+Math.round(t[0])+")"):e("label#price-label").html("Price ("+user.userCurrencySymbol+Math.round(t[0])+" - "+user.userCurrencySymbol+Math.round(t[1])+")");const r=s.get();r[0]===r[1]?e("label#score-label").html("Score ("+Math.round(r[0])+"%)"):e("label#score-label").html("Score ("+Math.round(r[0])+"% - "+Math.round(r[1])+"%)")}window.updateLabels=o,e(o);const l={order:[[2,"desc"]],createdRow:function(a,t,n){e(a).attr("data-app-id",t[1]),e(a).attr("data-link",t[4])},columnDefs:[{targets:0,render:function(e,a,t){return t[0].toLocaleString()},orderable:!1},{targets:1,render:function(e,a,t){return'<a href="'+t[4]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[3]+'" alt="" data-lazy-alt="'+t[2]+'"></div><div class="name">'+t[11]+"</div></a>"},createdCell:function(a,t,n,r,s){e(a).addClass("img")},orderable:!1},{targets:2,render:function(e,a,t){return t[7].toLocaleString()},orderSequence:["desc"]},{targets:3,render:function(e,a,t){return t[9].toLocaleString()},orderSequence:["desc"]},{targets:4,render:function(e,a,t){return t[5]+"%"},orderSequence:["desc"]},{targets:5,render:function(e,a,t){return t[6]},orderSequence:["desc"]},{targets:6,render:function(e,a,t){return t[8]?'<a href="'+t[8]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1},{targets:7,render:function(e,a,t){return t[10]},orderable:!1,visible:user.isLocal}]},i=e("#platforms"),c=[e("#user"),e("#tags"),e("#genres"),e("#categories"),e("#developers"),e("#publishers"),e("#types"),e("#search"),i,t,r];e("table.table").gdbTable({tableOptions:l,searchFields:c})}(jQuery,document);const $appsAchievementsPage=$("#apps-achievements-page");if($appsAchievementsPage.length>0){const e={order:[[1,"desc"]],createdRow:function(e,a,t){$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[3])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[3]+'" class="icon-name"><div class="icon"><img alt="" data-lazy="'+t[2]+'" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[5].toLocaleString()},orderSequence:["desc"]},{targets:2,render:function(e,a,t){return t[6].toLocaleString()+"%"},orderSequence:["desc"]},{targets:3,render:function(e,a,t){return t[4]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:4,render:function(e,a,t){return isIterable(t[7])?json2html.transform(t[7],{"<>":"img",src:"","data-lazy":"${k}","data-lazy-alt":"${v}",class:"mr-1","data-toggle":"tooltip","data-placement":"top","data-lazy-title":"${v}"}):""},createdCell:function(e,a,t,n,r){$(e).addClass("img"),$(e).attr("nowrap","nowrap")},orderable:!1}]},a=[$("#search")];$("table.table").gdbTable({tableOptions:e,searchFields:a})}const $appPage=$("#app-page");if($appPage.length>0){function loadNews(){const e=$("#article-feed");$.ajax({type:"GET",url:"/games/"+$appPage.attr("data-id")+"/news-feeds.json",dataType:"json",success:function(a,t,n){null===a&&(a=[]),$.each(a,function(a,t){e.append($("<option>",{value:t.id,text:t.name+" ("+t.count+")"}))}),window.location.hash.includes(",")||e.val("steam_community_announcements"),e.chosen({disable_search_threshold:5,allow_single_deselect:!0,max_selected_options:10});const r=$("#news-table"),s=r.gdbTable({searchFields:[$("#article-search"),e],tableOptions:{order:[[1,"desc"]],createdRow:function(e,a,t){$(e).attr("data-article-id",a[0]),$(e).addClass("cursor-pointer")},columnDefs:[{targets:0,render:function(e,a,t){return'<div class="icon-name"><div class="icon"><img class="tall" data-lazy="'+t[10]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"<br /><small>"+t[2]+'</small></div></div><div class="d-none">'+t[5]+"</div>"},createdCell:function(e,a,t,n,r){$(e).attr("style","min-width: 300px;"),$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return'<span data-toggle="tooltip" data-placement="left" title="'+t[4]+'" data-livestamp="'+t[3]+'"></span>'},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1}]}});r.on("click","tbody tr[role=row]",function(){const e=s.row($(this));e.child.isShown()?(e.child.hide(),$(this).removeClass("shown"),history.replaceState(null,null,"#news")):(e.child($("<div/>").html(e.data()[5])).show(),$(this).addClass("shown"),observeLazyImages($(this).next().find("img[data-lazy]")),history.replaceState(null,null,"#news,"+$(this).attr("data-article-id")))}),r.on("draw.dt",function(e,a){const t=window.location.hash;if(t){const e=t.match(/\d{19}/)[0];if(e){const a=$("tr[data-article-id="+e+"]");a.length>0&&(a.trigger("click"),$("html, body").animate({scrollTop:a.offset().top-100},200))}}})}})}function loadAppMediaTab(){$("#media #images img").each(function(){loadImage($(this))}),$("#media #videos video").each(function(){loadVideo($(this))})}function loadItems(){const e={order:[[2,"desc"]],createdRow:function(e,a,t){$(e).attr("data-id",a[0]),$(e).addClass("cursor-pointer")},columnDefs:[{targets:0,render:function(e,a,t){return t[12]},createdCell:function(e,a,t,n,r){},orderable:!1},{targets:1,render:function(e,a,t){return'<div class="icon-name"><div class="icon"><img class="tall" data-lazy="'+t[25]+'" alt="" data-lazy-alt="'+t[16]+'"></div><div class="name">'+t[16]+'<br><small title="'+t[4]+'">'+t[29]+"</small></div></div>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1},{targets:2,render:function(e,a,t){return t[28]?'<a href="'+t[28]+'" data-src="/assets/img/no-app-image-square.jpg" target="_blank" rel="noopener" class="stop-prop"><i class="fas fa-link"></i></a>':""},orderable:!1}]},a=$("#items-table"),t=[$("#items-search")],n=a.gdbTable({tableOptions:e,searchFields:t});a.on("click","tbody tr[role=row]",function(){const e=n.row($(this));if(e.child.isShown())e.child.hide(),$(this).removeClass("shown");else{const a=e.data(),t=[{Name:"App ID",Value:a[0]},{Name:"Bundle",Value:a[1]},{Name:"Commodity",Value:a[2]},{Name:"Date Created",Value:a[3]},{Name:"Description",Value:a[4]},{Name:"Display Type",Value:a[5]},{Name:"Drop Interval",Value:a[6]},{Name:"Drop Max Per Window",Value:a[7]},{Name:"Exchange",Value:a[8]},{Name:"Hash",Value:a[9]},{Name:"Icon URL",Value:'<a href="'+a[10]+'" target="_blank" rel="noopener">'+a[10]+"</a>"},{Name:"Icon URL Large",Value:'<a href="'+a[11]+'" target="_blank" rel="noopener">'+a[11]+"</a>"},{Name:"Item Def ID",Value:a[12]},{Name:"Item Quality",Value:a[13]},{Name:"Marketable",Value:a[14]},{Name:"Modified",Value:a[15]},{Name:"Name",Value:a[16]},{Name:"Price",Value:a[17]},{Name:"Promo",Value:a[18]},{Name:"Quantity",Value:a[19]},{Name:"Tags",Value:a[20]},{Name:"Timestamp",Value:a[21]},{Name:"Tradable",Value:a[22]},{Name:"Type",Value:a[23]},{Name:"Workshop ID",Value:a[24]}],n=json2html.transform(t,{"<>":"tr",class:"",html:[{"<>":"th",html:"${Name}",class:"nowrap"},{"<>":"td",html:"${Value}"}]});e.child('<table class="table table-hover table-striped table-sm mb-0">'+n+"</table>").show(),$(this).addClass("shown")}})}function loadAppSimilarSmall(){const e=$("#similar-owners-small").gdbTable({tableOptions:{language:{zeroRecords:function(){return"This app is yet to be scanned"}},createdRow:function(e,a,t){$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[1])},columnDefs:[{targets:0,render:function(e,a,t){return'<div class="icon-name"><div class="icon"><img data-lazy="'+t[2]+'" alt="" data-lazy-alt="'+t[3]+'"></div><div class="name">'+t[3]+"</div></div>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1}]}});e.on("draw.dt",function(a,t){e.page.info().recordsTotal||$("#same-owners-small-wrapper div.card-footer").remove()})}function loadNewsSmall(){const e=$("#news-small");e.gdbTable({tableOptions:{language:{zeroRecords:function(){return"No community news yet"}},createdRow:function(e,a,t){$(e).attr("data-article-id",a[0]),$(e).addClass("cursor-pointer")},columnDefs:[{targets:0,render:function(e,a,t){return'<div class="icon-name"><div class="name">'+t[1]+'<br /><small><span data-toggle="tooltip" data-placement="left" title="'+t[4]+'" data-livestamp="'+t[3]+'"></span></small></div></div>'},createdCell:function(e,a,t,n,r){$(e).attr("style","min-width: 300px;"),$(e).addClass("img")},orderable:!1}]}});e.on("click","tbody tr[role=row]",function(){history.pushState(null,null,"#news,"+$(this).attr("data-article-id")),$('a.nav-link[href="#news"]').tab("show")})}function loadAppSimilar(){$("#similar-owners").gdbTable({order:[[3,"desc"]],tableOptions:{serverSide:!1,language:{zeroRecords:function(){return"This app is yet to be scanned"}},createdRow:function(e,a,t){$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[1])},columnDefs:[{targets:0,render:function(e,a,t){return'<div class="icon-name"><div class="icon"><img class="tall" data-lazy="'+t[2]+'" alt="" data-lazy-alt="'+t[3]+'"></div><div class="name">'+t[3]+"</div></div>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderSequence:["asc","desc"]},{targets:1,render:function(e,a,t){return t[5].toLocaleString()},orderSequence:["desc","asc"]},{targets:2,render:function(e,a,t){return t[6].toLocaleString()},orderSequence:["desc","asc"]},{targets:3,render:function(e,a,t){return t[7].toFixed(2).toLocaleString()},orderSequence:["desc","asc"]},{targets:4,render:function(e,a,t){return t[4]?'<a href="'+t[4]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1}]}});const e=$("#similar-tags");$.ajax({type:"GET",url:"/games/"+$appPage.attr("data-id")+"/similar.html",dataType:"html",success:function(a,t,n){null===a&&(a=""),e.html(a),observeLazyImages(e.find("img[data-lazy]"))}})}function loadAppReviewsChart(){$.ajax({type:"GET",url:"/games/"+$appPage.attr("data-id")+"/reviews.html",dataType:"html",success:function(e,a,t){null===e&&(e=""),$("#reviews-ajax").html(e)}}),$.ajax({type:"GET",url:"/games/"+$appPage.attr("data-id")+"/reviews.json",dataType:"json",success:function(e,a,t){null===e&&(e=[]),Highcharts.chart("reviews-chart",$.extend(!0,{},defaultChartOptions,{yAxis:[{allowDecimals:!1,title:{text:""},min:0,max:100,endOnTick:!1,labels:{formatter:function(){return this.value+"%"}}},{allowDecimals:!1,title:{text:""},opposite:!0}],tooltip:{formatter:function(){const e=moment(this.key).format("dddd DD MMM YYYY @ HH:mm");return"Score"===this.series.name?this.y.toLocaleString()+"% Review score on "+e:"Positive Reviews"===this.series.name?this.y.toLocaleString()+" Positive reviews on "+e:"Negative Reviews"===this.series.name?Math.abs(this.y).toLocaleString()+" Negative reviews on "+e:void 0}},series:[{type:"line",name:"Score",color:"#007bff",data:e.mean_reviews_score,yAxis:0,marker:{symbol:"circle"}},{type:"area",name:"Positive Reviews",color:"#28a745",data:e.mean_reviews_positive,yAxis:1,marker:{symbol:"circle"}},{type:"area",name:"Negative Reviews",color:"#e83e8c",data:e.mean_reviews_negative,yAxis:1,marker:{symbol:"circle"}}]}))}})}function loadAppPlayersChart(){const e=new Date;e.setDate(e.getDate()-7);const a=$.extend(!0,{},defaultChartOptions,{yAxis:[{allowDecimals:!1,title:{text:""},min:0,opposite:!1,labels:{formatter:function(){return this.value.toLocaleString()}},visible:!0},{allowDecimals:!1,title:{text:""},min:0,opposite:!0,labels:{formatter:function(){return this.value.toLocaleString()}},visible:!0}],xAxis:{plotLines:plotline($appPage.attr("data-release"),"Steam Release")},plotOptions:{series:{marker:{enabled:!1}}},tooltip:{formatter:function(){switch(this.series.name){case"Players Online":return this.y.toLocaleString()+" players on "+moment(this.key).format("dddd DD MMM YYYY @ HH:mm");case"Players Online (Average)":return this.y.toLocaleString()+" average players on "+moment(this.key).format("dddd DD MMM YYYY @ HH:mm");case"Twitch Viewers":return this.y.toLocaleString()+" Twitch viewers on "+moment(this.key).format("dddd DD MMM YYYY @ HH:mm");case"YouTube Views":return this.y.toLocaleString()+" YouTube views on "+moment(this.key).format("dddd DD MMM YYYY");case"YouTube Comments":return this.y.toLocaleString()+" YouTube comments on "+moment(this.key).format("dddd DD MMM YYYY")}}}}),t=function(e){let a=[{name:"Players Online (Average)",color:"#28a74544",data:e.max_moving_average,connectNulls:!0,yAxis:0},{name:"Players Online",color:"#28a745",data:e.max_player_count,connectNulls:!0,yAxis:0}];return user.isLoggedIn&&a.unshift({name:"YouTube Comments",color:"#ff0000",data:e.max_youtube_comments,connectNulls:!0,type:"line",step:"right",visible:!1,yAxis:1},{name:"YouTube Views",color:"#ff0000",data:e.max_youtube_views,connectNulls:!0,type:"line",step:"right",visible:!1,yAxis:1}),a};$.ajax({type:"GET",url:"/games/"+$appPage.attr("data-id")+"/players.json",dataType:"json",success:function(n,r,s){const o=$("#players-chart");if(!n||0===Object.keys(n).length)return void o.html("No players.").css("height","auto");const l=e.getTime();let i=0;isIterable(n.max_youtube_views)&&n.max_youtube_views.forEach(function(e,a,t){e[0]>l&&null!=e[1]&&e[1]>i&&(i=e[1])}),$("#youtube-max-views").html(i.toLocaleString()),i=0,isIterable(n.max_youtube_comments)&&n.max_youtube_comments.forEach(function(e,a,t){e[0]>l&&null!=e[1]&&e[1]>i&&(i=e[1])}),$("#youtube-max-comments").html(i.toLocaleString()),Highcharts.chart(o[0],$.extend(!0,{},a,{xAxis:{min:e.getTime()},series:t(n)}))}}),$.ajax({type:"GET",url:"/games/"+$appPage.attr("data-id")+"/players2.json",dataType:"json",success:function(e,n,r){const s=$("#players-chart2");e&&0!==Object.keys(e).length?Highcharts.chart(s[0],$.extend(!0,{},a,{chart:{zoomType:"x"},series:t(e)})):s.html("No players.").css("height","auto")}})}function loadAppPlayersHeatmapChart(){const e=$("#heatmap-timezones");let a=Math.floor(moment().utcOffset()/60);a>=0&&(a="+"+a),e.val(a),$.ajax({type:"GET",url:"/games/"+$appPage.attr("data-id")+"/players-heatmap.json",dataType:"json",success:function(t,n,r){const s=$("#players-heatmap-chart");if(!t||0===Object.keys(t).length)return void s.html("No players.").css("height","auto");let o;e.on("change",function(){o&&o.destroy(),o=Highcharts.chart(s[0],$.extend(!0,{},defaultChartOptions,{chart:{type:"heatmap"},xAxis:{title:null,type:"category",lineColor:"rgba(0,0,0,0)"},yAxis:{categories:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],title:null,reversed:!0,gridLineColor:"rgba(0,0,0,0)"},legend:{enabled:!0,align:"right",layout:"vertical",verticalAlign:"middle"},tooltip:{formatter:function(){const e=this.series.yAxis.categories[this.point.y],t=this.point.x;return"Average of last 4 "+e+"s @ "+pad(t,2)+":00-"+pad(t,2)+":59 "+a+": ~"+Math.round(this.point.value).toLocaleString()+" players"}},colorAxis:{minColor:darkMode?"#212529":"#FFFFFF",maxColor:defaultChartOptions.colors[0],reversed:!1},plotOptions:{series:{marker:{enabled:!0}}},series:[{data:adjustZone(t.max_player_count,e.val()),borderWidth:0}]}))}),e.trigger("change")}})}function adjustZone(e,a){const t=$.extend(!0,[],e);return t.forEach(function(e,n){0!==(a=parseInt(a))&&(t[n][0]+=a,t[n][0]>23?(t[n][0]-=24,t[n][1]++):t[n][0]<0&&(t[n][0]+=24,t[n][1]--),t[n][1]>6?t[n][1]-=7:t[n][1]<0&&(t[n][1]+=7))}),t}function loadAppWishlist(){$.ajax({type:"GET",url:"/games/"+$appPage.attr("data-id")+"/wishlist.json",dataType:"json",success:function(e,a,t){null===e&&(e={}),Highcharts.chart("wishlists-chart",$.extend(!0,{},defaultChartOptions,{yAxis:[{title:{text:""},labels:{formatter:function(){return this.value.toLocaleString()}}},{title:{text:"Wishlists"},labels:{formatter:function(){return this.value.toFixed(7)+"%"}}},{opposite:!0,reversed:!0,title:{text:"Average Position"},labels:{formatter:function(){return this.value.toLocaleString()}}}],xAxis:{plotLines:plotline($appPage.attr("data-release"),"Steam Release")},tooltip:{formatter:function(){switch(this.series.name){case"Wishlists":return"In "+this.y.toLocaleString()+" wishlists on "+moment(this.key).format("dddd DD MMM YYYY");case"Wishlists %":return"In "+this.y.toFixed(7)+"% of wishlists on "+moment(this.key).format("dddd DD MMM YYYY");case"Average Position":return"Average position of "+this.y.toFixed(2).toLocaleString()+" on "+moment(this.key).format("dddd DD MMM YYYY")}}},series:[{name:"Wishlists",color:"#007bff",data:e.mean_wishlist_count,marker:{symbol:"circle"},yAxis:0},{name:"Wishlists %",color:"#28a745",data:e.mean_wishlist_percent,marker:{symbol:"circle"},yAxis:1},{name:"Average Position",color:"#e83e8c",data:e.mean_wishlist_avg_position,marker:{symbol:"circle"},yAxis:2}]}))}})}function loadAppPlayerTimes(){const e={order:[[3,"desc"]],createdRow:function(e,a,t){$(e).attr("data-id",a[0]),$(e).attr("data-link",a[6])},columnDefs:[{targets:0,render:function(e,a,t){return t[4]},createdCell:function(e,a,t,n,r){$(e).addClass("font-weight-bold")},orderable:!1},{targets:1,render:function(e,a,t){return t[3]?'<img data-lazy="'+t[3]+'" alt="" data-lazy-alt="'+t[7]+'" class="wide" data-toggle="tooltip" data-placement="left" data-lazy-title="'+t[7]+'" class="rounded">':""},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1},{targets:2,render:function(e,a,t){return'<a href="'+t[6]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[5]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1},{targets:3,render:function(e,a,t){return t[2]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1}]};$("#top-players-table").gdbTable({tableOptions:e})}function loadAchievements(){const e=$appPage.attr("data-id");$("select#achievements-filter").chosen({disable_search_threshold:5,allow_single_deselect:!1,max_selected_options:1}),loadFriends(e,!1,function(a){const t=a.val();t&&(window.location.href="/games/"+e+"/compare-achievements/"+user.playerID+","+t)}),$.ajax({type:"GET",url:"/games/"+$appPage.attr("data-id")+"/achievement-counts.json",dataType:"json",success:function(e,a,t){null===e&&(e={}),e.hasOwnProperty("data")||(e.data=[]),e.data?Highcharts.chart("achievement-counts-chart",$.extend(!0,{},defaultChartOptions,{legend:{enabled:!1},yAxis:{allowDecimals:!1,title:{text:""},min:0},xAxis:{type:"category",plotLines:plotline(e.marker,"You are here!"),min:0===e.marker?0:1},tooltip:{formatter:function(){return this.y.toLocaleString()+" players have "+this.x.toLocaleString()+" achievements"}},series:[{data:e.data}]})):$("#achievement-counts-chart").css("height","auto").html("No data")}}),$("#achievements-table").gdbTable({searchFields:[$("#achievements-filter")],tableOptions:{pageLength:1e3,order:[[2,"desc"]],createdRow:function(e,a,t){user.isLocal&&$(e).attr("data-ach-id",a[9])},columnDefs:[{targets:0,render:function(e,a,t){let n=t[0];return n||(n=t[9]),t[4]||(n+='<span class="badge badge-danger float-right ml-1">Inactive</span>'),t[5]&&(t[1]="<em>&lt;Hidden&gt;</em> "+t[1]),t[6]&&(n+='<span class="badge badge-danger float-right ml-1">Deleted</span>'),n+="<br><small>"+t[1]+"</small>",'<div class="icon-name"><div class="icon"><img class="tall" data-lazy="'+t[2]+'" alt="" data-lazy-alt="'+t[0]+'"></div><div class="name">'+n+"</div></div>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[7]&&t[7]>0?'<span data-livestamp="'+t[7]+'"></span><br><small class="text-muted">'+t[8]+"</small>":-1===t[7]?"Unknown":""},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:2,render:function(e,a,t){return t[3]+"%"},createdCell:function(e,a,t,n,r){t[3]=Math.ceil(t[3]),$(e).css("background","linear-gradient(to right, rgba(0,0,0,.15) "+t[3]+"%, transparent "+t[3]+"%)"),$(e).addClass("thin")},orderSequence:["desc","asc"]}]}})}function loadDLC(){const e={order:[[1,"desc"]],createdRow:function(e,a,t){$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[5])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[5]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[2]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderSequence:["asc","desc"]},{targets:1,render:function(e,a,t){return t[3]?'<span data-toggle="tooltip" data-placement="left" title="'+t[4]+'" data-livestamp="'+t[3]+'"></span>':t[4]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]}]},a=[$("#dlc-search")];$("#dlc-table").gdbTable({tableOptions:e,searchFields:a})}function loadAppBundlesTab(){const e={serverSide:!1,order:[[0,"asc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[1])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[1]+'" class="icon-name"><div class="icon"><img data-lazy="/assets/img/no-app-image-square.jpg" alt="" data-lazy-alt="'+t[2]+'"></div><div class="name">'+t[2]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderSequence:["asc","desc"]},{targets:1,render:function(e,a,t){return t[3]+"%"},orderSequence:["desc","asc"]},{targets:2,render:function(e,a,t){return t[4].toLocaleString()},orderSequence:["desc","asc"]},{targets:3,render:function(e,a,t){return t[5].toLocaleString()},orderSequence:["desc","asc"]},{targets:4,render:function(e,a,t){return t[6]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]}]};$("#bundles-table").gdbTable({tableOptions:e})}function loadAppPackagesTab(){const e={serverSide:!1,order:[[0,"asc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[1])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[1]+'" class="icon-name"><div class="icon"><img data-lazy="/assets/img/no-app-image-square.jpg" alt="" data-lazy-alt="'+t[2]+'"></div><div class="name">'+t[2]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderSequence:["asc","desc"]},{targets:1,render:function(e,a,t){return t[3]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["asc","desc"]},{targets:2,render:function(e,a,t){return t[4]},orderSequence:["asc","desc"]},{targets:3,render:function(e,a,t){return t[5]},orderSequence:["asc","desc"]},{targets:4,render:function(e,a,t){return t[6]},orderSequence:["desc","asc"]}]};$("#packages-table").gdbTable({tableOptions:e})}function loadDevLocalization(){$.ajax({type:"GET",url:"/games/"+$appPage.attr("data-id")+"/localization.html",dataType:"html",success:function(e,a,t){null===e&&(e=""),$("#dev-localization").html(e)}})}function loadAppTags(){$.ajax({type:"GET",url:"/games/"+$appPage.attr("data-id")+"/tags.json",dataType:"json",success:function(e,a,t){let n=[];if(isIterable(e.order))for(const a of e.order)n.push({name:e.names[a],data:e.counts["tag_"+a.toString()]});Highcharts.chart("tags-chart",$.extend(!0,{},defaultChartOptions,{yAxis:{title:{text:"Votes"}},series:n}))}})}$("#scroll-to-videos").on("mouseup",function(e){const a=$("#videos video").first(),t=$(window).height()/2-a.height()/2;$("html, body").animate({scrollTop:a.offset().top-t},500),a[0].paused&&a.trigger("click")}),$("#details video").on("mouseup",function(e){const a=$(this)[0];a.paused?a.play():($('a.nav-link[href="#media"]').tab("show"),$("#scroll-to-videos").trigger("mouseup"))}),$("#dev-info").on("mouseup","tr",function(){const e=$(this),a=$(this).closest("table").DataTable().row(e);a.child.isShown()?(a.child.hide(),e.removeClass("shown")):(a.child(function(){return'<code class="wbba">'+e.data("raw")+"</code>"}).show(),e.addClass("shown"))}),loadAjaxOnObserve({news:loadNews,"news-small":loadNewsSmall,items:loadItems,prices:loadPriceChart,"similar-owners":loadAppSimilar,"similar-owners-small":loadAppSimilarSmall,reviews:loadAppReviewsChart,achievements:loadAchievements,dlc:loadDLC,"dev-localization":loadDevLocalization,media:loadAppMediaTab,"tags-chart":loadAppTags,"bundles-table":loadAppBundlesTab,"packages-table":loadAppPackagesTab,"players-chart":loadAppPlayersChart,"players-heatmap-chart":loadAppPlayersHeatmapChart,"group-chart":function(){loadGroupChart($appPage)},"top-players-table":loadAppPlayerTimes,"wishlists-chart":loadAppWishlist}),$('a[data-toggle="tab"]').on("shown.bs.tab",function(e){"#media"===$(e.relatedTarget).attr("href")&&pauseAllVideos()}),user.toasts&&user.toasts.length>0&&websocketListener("app",function(e){JSON.parse(e.data).Data.toString()===$appPage.attr("data-id")&&toast(!0,"Click to refresh","This app has been updated",0,"refresh")})}const $appsAchievementsComparePage=$("#apps-achievements-compare-page");if($appsAchievementsComparePage.length>0){const e=$appsAchievementsComparePage.attr("data-app-id");loadFriends(e,!1,function(a){const t=a.val();if(t){let a=window.location.pathname.split("/"),n=5===a.length?a[4].split(","):[];n.push(t),n=[...new Set(n)],window.location.href="/games/"+e+"/compare-achievements/"+n.join(",")}})}const $appsComparePage=$("#apps-compare-page");if($appsComparePage.length>0){function loadCompareSearchTable(){const e={order:[[0,"asc"]],createdRow:function(e,a,t){$(e).attr("data-app-id",a[1])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[4]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[3]+'" alt="" data-lazy-alt="'+t[2]+'"></div><div class="name">'+t[2]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[6]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:2,render:function(e,a,t){return t[8]?'<a href="'+t[7]+'" ><i class="fas fa-minus"></i> Remove</a>':'<a href="'+t[7]+'" ><i class="fas fa-plus"></i> Add</a>'},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:3,render:function(e,a,t){return t[5]?'<a href="'+t[5]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1},{targets:4,render:function(e,a,t){return t[9]},orderable:!1,visible:user.isLocal}]},a=$("#ids"),t=$("#search");$("#search-table").gdbTable({tableOptions:e,searchFields:[a,t]}).on("draw.dt",function(e,a){t.val()?$("#search-results").show():$("#search-results").hide()}),$("#apps-table").gdbTable({tableOptions:e,searchFields:[a]})}function loadComparePlayersChart(){if($.isEmptyObject(appNames))return;const e=$.extend(!0,{},defaultChartOptions,{yAxis:{allowDecimals:!1,title:{text:""},min:0,opposite:!1,labels:{formatter:function(){return this.value.toLocaleString()}},visible:!0},plotOptions:{series:{marker:{enabled:!1}}},tooltip:{formatter:function(){return this.series.name+" had "+this.y.toLocaleString()+" players on "+moment(this.key).format("dddd DD MMM YYYY @ HH:mm")}}});$.ajax({type:"GET",url:"/games/compare/"+$appsComparePage.attr("data-id")+"/players.json",dataType:"json",cache:!0,success:function(a,t,n){let r=[];for(const e of a)r.push({name:appNames[e.key],data:e.value.max_player_count,connectNulls:!0});Highcharts.chart("players-chart",$.extend(!0,{},e,{series:r}))}}),$.ajax({type:"GET",url:"/games/compare/"+$appsComparePage.attr("data-id")+"/players2.json",dataType:"json",cache:!0,success:function(a,t,n){let r=[];for(const e of a)r.push({name:appNames[e.key],data:e.value.max_player_count,connectNulls:!0});Highcharts.chart("players-chart2",$.extend(!0,{},e,{series:r}))}})}function loadCompareFollowersChart(e=null){$.isEmptyObject(groupNames)||$.ajax({type:"GET",url:"/games/compare/"+$appsComparePage.attr("data-group-id")+"/members.json",dataType:"json",cache:!0,success:function(e,a,t){let n=[];for(const a of e)n.push({name:groupNames[a.key],data:a.value.max_members_count,connectNulls:!0});Highcharts.chart("group-chart",$.extend(!0,{},defaultChartOptions,{yAxis:{allowDecimals:!1,title:{text:""},labels:{formatter:function(){return this.value.toLocaleString()}}},tooltip:{formatter:function(){return this.series.name+" had members on "+moment(this.key).format("dddd DD MMM YYYY @ HH:mm")}},series:n}))}})}function loadCompareScoreChart(){$.isEmptyObject(appNames)||$.ajax({type:"GET",url:"/games/compare/"+$appsComparePage.attr("data-id")+"/reviews.json",dataType:"json",cache:!0,success:function(e,a,t){let n=[];for(const a of e)n.push({name:appNames[a.key],data:a.value.mean_reviews_score,connectNulls:!0});Highcharts.chart("score-chart",$.extend(!0,{},defaultChartOptions,{yAxis:{allowDecimals:!1,title:{text:""},min:0,max:100,endOnTick:!1,labels:{formatter:function(){return this.value+"%"}}},tooltip:{formatter:function(){return this.series.name+" had a review score of "+this.y.toLocaleString()+"% on "+moment(this.key).format("dddd DD MMM YYYY @ HH:mm")}},series:n}))}})}function loadComparePriceChart(){$.isEmptyObject(appNames)||$.ajax({type:"GET",url:"/games/compare/"+$appsComparePage.attr("data-id")+"/prices.json",dataType:"json",cache:!0,success:function(e,a,t){let n=[];for(const a of e)n.push({name:appNames[a.key],data:a.value.price,type:"line",step:"left"});Highcharts.chart("price-chart",$.extend(!0,{},defaultChartOptions,{yAxis:{title:{text:"Price ("+user.userCurrencySymbol+")"},allowDecimals:!0,min:0},series:n}))}})}function loadCompareWishlistChart(){$.isEmptyObject(appNames)||$.ajax({type:"GET",url:"/games/compare/"+$appsComparePage.attr("data-id")+"/wishlists.json",dataType:"json",cache:!0,success:function(e,a,t){let n=[];for(const a of e)n.push({name:appNames[a.key],data:a.value.mean_wishlist_count,connectNulls:!0});Highcharts.chart("wishlists-chart",$.extend(!0,{},defaultChartOptions,{yAxis:{allowDecimals:!1,title:{text:""}},tooltip:{formatter:function(){return this.series.name+" is in "+this.y.toLocaleString()+" wishlists on "+moment(this.key).format("dddd DD MMM YYYY")}},series:n}))}})}loadAjaxOnObserve({"apps-table":loadCompareSearchTable,"players-chart":loadComparePlayersChart,"group-chart":loadCompareFollowersChart,"score-chart":loadCompareScoreChart,"wishlists-chart":loadCompareWishlistChart,"price-chart":loadComparePriceChart})}$("#apps-dlc-page").length>0&&$("table.table").gdbTable({searchFields:[$("#search")],tableOptions:{order:[[0,"asc"]],createdRow:function(e,a,t){$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[3])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[3]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[2]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderSequence:["asc","desc"]},{targets:1,render:function(e,a,t){return t[4].toLocaleString()},orderSequence:["desc","asc"]},{targets:2,render:function(e,a,t){return t[5].toLocaleString()},createdCell:function(e,a,t,n,r){const s=t[5]/t[4]*100;$(e).css({background:"linear-gradient(to right, rgba(0,0,0,.15) "+s+"%, transparent "+s+"%)","border-right":"solid 1px rgba(0, 0, 0, 0.15)"})},orderable:!1},{targets:3,render:function(e,a,t){return t[6]?'<a href="'+t[6]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1}]}}),$("#apps-random-page").length>0&&($("#find-another").on("click",function(e){window.location.reload(!0)}),$("select.form-control-chosen").chosen({disable_search_threshold:5,allow_single_deselect:!0,max_selected_options:1}),$("#search-card select").on("change",function(e){const a=new URLSearchParams(location.search);$(this).val()?a.set($(this).attr("name"),$(this).val()):a.delete($(this).attr("name")),window.location.href=window.location.pathname+"?"+a.toString()}),$(function(){const e=$("#search-card select");window.location.search&&e.deserialize(window.location.search.replace("?","")),e.trigger("chosen:updated")})),$("#release-dates-page").length>0&&$("table.table").gdbTable({tableOptions:{order:[[4,"asc"]],createdRow:function(e,a,t){$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[3])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[3]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[2]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img"),$(e).attr("nowrap","nowrap")},orderable:!1},{targets:1,render:function(e,a,t){return t[6]},orderable:!1},{targets:2,render:function(e,a,t){return t[4].toLocaleString()},orderSequence:["desc"]},{targets:3,render:function(e,a,t){return t[5]?'<a href="'+t[5]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1},{targets:4,render:function(e,a,t){return t[7]},orderable:!1,orderSequence:["asc","desc"],visible:user.isLocal}]}});const $trendingAppsPage=$("#trending-apps-page"),$trendingAppsTable=$("table.table");if($trendingAppsPage.length>0){const e={order:[[3,"desc"]],createdRow:function(e,a,t){$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[3])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[3]+'" class="icon-name"><div class="icon"><img alt="" data-lazy="'+t[2]+'" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[4]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:2,render:function(e,a,t){return t[6].toLocaleString()},orderSequence:["desc"]},{targets:3,render:function(e,a,t){return t[5].toLocaleString()},orderSequence:["desc","asc"]},{targets:4,render:function(e,a,t){return'<div data-app-id="'+t[0]+'"><i class="fas fa-spinner fa-spin"></i></div>'},createdCell:function(e,a,t,n,r){$(e).addClass("chart")},orderable:!1}]};$trendingAppsTable.gdbTable({tableOptions:e})}if($trendingAppsPage.length>0||$("#new-releases-page").length>0){function loadCharts(){const e=$("td.chart div[data-app-id]").map(function(){return $(this).attr("data-app-id")}).get().join(",");$.ajax({type:"GET",url:"/games/trending/charts.json?ids="+e,dataType:"json",success:function(e,a,t){null!==e&&$("div[data-app-id]").each(function(a){let t;const n=$(this).attr("data-app-id");t=null!==e&&n in e&&"max_player_count"in e[n]?e[n].max_player_count:[],Highcharts.chart(this,$.extend(!0,{},defaultChartOptions,{chart:{type:"area",margin:[0,0,0,0],skipClone:!0,height:32},legend:{enabled:!1},xAxis:{labels:{enabled:!1}},yAxis:{title:{text:null},labels:{enabled:!1},min:0},plotOptions:{series:{marker:{enabled:!1}}},tooltip:{hideDelay:0,outside:!0,shared:!0,formatter:function(){return this.y.toLocaleString()+" players on "+moment(this.x).format("dddd DD MMM YYYY @ HH:mm")},style:{width:"500px"}},series:[{color:"#28a745",data:t}]}))})}})}$trendingAppsTable.on("draw.dt",function(e,a,t){loadCharts()})}const $badgePage=$("#badge-page");if($badgePage.length>0){const e={order:[[2,"desc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[5])},columnDefs:[{targets:0,createdCell:function(e,a,t,n,r){$(e).addClass("font-weight-bold")},render:function(e,a,t){return t[0]}},{targets:1,render:function(e,a,t){return'<a href="'+t[5]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[2]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")}},{targets:2,render:function(e,a,t){return t[3].toLocaleString()}},{targets:3,render:function(e,a,t){return t[4]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")}},{targets:4,render:function(e,a,t){return t[6]?'<a href="'+t[6]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1}]};$("table.table").gdbTable({tableOptions:e})}const $bundlePage=$("#bundle-page");if($bundlePage.length>0&&$.ajax({type:"GET",url:"/bundles/"+$bundlePage.attr("data-id")+"/prices.json",dataType:"json",success:function(e,a,t){null===e&&(e=[]),Highcharts.chart("prices-chart",$.extend(!0,{},defaultChartOptions,{legend:{enabled:!1},tooltip:{formatter:function(){return this.y.toLocaleString()+"% discount on "+moment(this.x).format("dddd DD MMM YYYY @ HH:mm")}},xAxis:{labels:{step:1,formatter:function(){return moment(this.value).format("Do MMM YY")}}},yAxis:{title:{text:""},type:"linear",max:100,min:0,allowDecimals:!1,labels:{formatter:function(){return this.value+"%"}}},series:[{type:"line",name:"Price",step:"left",color:"#28a745",data:e}]}))}}),$("#bundles-page").length>0){$("select.form-control-chosen").chosen({disable_search_threshold:5,allow_single_deselect:!0,max_selected_options:10});const e=$("#discount"),a=noUiSlider.create(e[0],{start:[0,100],connect:!0,step:1,range:{min:0,max:100},format:{to:e=>parseFloat(e).toFixed(0),from:e=>parseFloat(e).toFixed(0)}}),t=$("#apps"),n=noUiSlider.create(t[0],{start:[0,100],connect:!0,step:1,range:{min:0,max:100},format:{to:e=>parseFloat(e).toFixed(0),from:e=>parseFloat(e).toFixed(0)}});function updateLabels(e){const t=a.get();t[0]===t[1]?$("label[for=discount]").html("Discount ("+Math.round(t[0])+")"):$("label[for=discount]").html("Discount ("+Math.round(t[0])+" - "+Math.round(t[1])+")");const r=n.get(),s="100"===r[1]?"100+":r[1];r[0]===r[1]?$("label[for=apps]").html("Apps ("+s+")"):$("label[for=apps]").html("Apps ("+r[0]+" - "+s+")")}window.updateLabels=updateLabels,$(updateLabels);const r={order:[[6,"desc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[2])},columnDefs:[{targets:0,render:function(e,a,t){let n=t[1];return t[7]&&(n+=' <span class="badge badge-success">Lowest</span>'),'<a href="'+t[2]+'" class="icon-name"><div class="icon"><img src="/assets/img/no-app-image-square.jpg" alt="'+t[1]+'"></div><div class="name">'+n+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){let n=t[13]+"%";return t[13]>t[4]&&(n+=" <small>"+t[4]+"%<small>"),n},orderSequence:["asc","desc"]},{targets:2,createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},render:function(e,a,t){if(user.prodCC in t[9]){let e=t[9][user.prodCC];return user.prodCC in t[11]&&t[11][user.prodCC]!==t[9][user.prodCC]&&(e+=" <small>"+t[11][user.prodCC]+"</small>"),e}return"-"},orderSequence:["asc","desc"]},{targets:3,render:function(e,a,t){return t[5].toLocaleString()},orderSequence:["desc","asc"]},{targets:4,render:function(e,a,t){return t[6]?'<i class="fas fa-check text-success fa-fw"></i>':'<i class="fas fa-times text-danger fa-fw"></i>'},orderable:!1},{targets:5,render:function(e,a,t){return"cts"===t[12]?'<i class="fas fa-check text-success fa-fw"></i>':'<i class="fas fa-times text-danger fa-fw"></i>'},orderable:!1},{targets:6,createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},render:function(e,a,t){return'<span data-livestamp="'+t[3]+'"></span>'},orderSequence:["desc"]},{targets:7,render:function(e,a,t){return t[8]?'<a href="'+t[8]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1},{targets:8,render:function(e,a,t){return t[10]},orderable:!1,visible:user.isLocal}]},s=$("table.table"),o=[$("#search"),e,t,$("#type"),$("#giftable"),$("#onsale")],l=serialiseTable(o,r.order),i=s.gdbTable({tableOptions:r,searchFields:o});websocketListener("bundles",function(e){if(Object.toJSON(l)===Object.toJSON(serialiseTable(o,i.order()))){const a=i.page.info();if(0===a.page)return void addDataTablesRow(r,JSON.parse(e.data).Data,a.length,s)}toast(!0,"Reset table filters/sorting/page to show live","New Bundle Found")})}if($("#changes-page").length>0){const e={order:[[1,"desc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[5])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[5]+'" class="icon-name"><div class="icon"><img src="/assets/img/no-app-image-square.jpg" alt="'+t[1]+'"></div><div class="name">'+t[6]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap"),$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return'<span data-toggle="tooltip" data-placement="left" title="'+t[2]+'" data-livestamp="'+t[1]+'"></span>'},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:2,render:function(e,a,t){let n=[];if(null!==t[3])for(let e in t[3])t[3].hasOwnProperty(e)&&(""===t[3][e].name&&(t[3][e].name="Unknown App"),n.push('<a href="'+t[3][e].path+'">'+t[3][e].name+"</a>"));return n.join("<br/>")},orderable:!1},{targets:3,render:function(e,a,t){let n=[];if(null!==t[4])for(let e in t[4])t[4].hasOwnProperty(e)&&(""===t[4][e].name&&(t[4][e].name="Unknown Package"),n.push('<a href="'+t[4][e].path+'">'+t[4][e].name+"</a>"));return n.join("<br/>")},orderable:!1}]},a=$("table.table"),t=a.gdbTable({tableOptions:e});websocketListener("changes",function(n){const r=t.page.info();if(0===r.page){const t=JSON.parse(n.data);if(isIterable(t.Data)){t.Data.sort(function(e,a){return Math.sign(e[0]-a[0])});for(const n of t.Data)addDataTablesRow(e,n,r.length,a)}}})}if($("#chat-page").length>0){const e=$("[data-channel-id]").attr("data-channel-id");function chatRow(e,a=!0){const t=$("ul[data-channel-id="+e.channel+"]"),n=a?" fade-green":"";!e.content&&e.embeds&&(e.content="<small>Media content not available on our website, please view in Discord</small>"),t.json2html(e,{"<>":"li",class:"media fade-in",style:"animation-delay: ${i}s",html:[{"<>":"img",class:"mr-3 rounded",alt:"","data-lazy-alt":"${author_user}","data-lazy":function(e,a){return e.author_avatar?"https://cdn.discordapp.com/avatars/"+e.author_id+"/"+e.author_avatar+".png?size=64":"/assets/img/no-app-image-square.jpg"}},{"<>":"div",class:"media-body",html:[{"<>":"h5",class:"mt-0 mb-1 rounded"+n,html:"${content}"},{"<>":"p",class:"text-muted",html:"By ${author_user}"}]}]},{prepend:a}),t.find("li").slice(50).remove(),observeLazyImages(t.find("img[data-lazy]"))}$.ajax({url:"/chat/"+e+"/chat.json",dataType:"json",cache:!1,success:function(e,a,t){if($(".fa-spin").remove(),isIterable(e))for(const a of e)chatRow(a,!1)}}),websocketListener("chat",function(e){chatRow(JSON.parse(e.data).Data)})}if($("#chat-bot-page").length>0){function loadChart(){$.ajax({type:"GET",url:"/discord-bot/chart.json",dataType:"json",success:function(e,a,t){null===e&&(e=[]),Highcharts.chart("chart",$.extend(!0,{},defaultChartOptions,{yAxis:[{allowDecimals:!1,title:{text:""},labels:{formatter:function(){return this.value.toLocaleString()}}},{allowDecimals:!1,title:{text:""},labels:{formatter:function(){return this.value.toLocaleString()}},opposite:!0}],tooltip:{formatter:function(){switch(this.series.name){case"Requests":return this.y.toLocaleString()+" requests at "+moment(this.key).format("dddd DD MMM YYYY @ HH:00");case"Servers":return"On "+this.y.toLocaleString()+" servers on "+moment(this.key).format("dddd DD MMM YYYY @ HH:00")}}},plotOptions:{series:{fillColor:{linearGradient:{x1:0,x2:0,y1:0,y2:1},stops:[[0,defaultChartOptions.colors[0]+"FF"],[1,defaultChartOptions.colors[0]+"00"]]}}},series:[{name:"Servers",data:e.max_guilds,yAxis:1,color:defaultChartOptions.colors[1],marker:{symbol:"circle"}},{name:"Requests",data:e.sum_request,yAxis:0,color:defaultChartOptions.colors[0],marker:{symbol:"circle"},type:"area",step:"left"}]}))}})}function loadLatest(){const e={order:[[2,"desc"]],columnDefs:[{targets:0,render:function(e,a,t){return'<div class="icon-name"><div class="icon"><img class="tall" alt="" data-lazy="https://cdn.discordapp.com/avatars/'+t[0]+"/"+t[2]+'.png?size=64" data-lazy-alt="'+t[1]+'"></div><div class="name nowrap">'+t[1]+"<br><small>"+t[6]+"</small></div></div>"},createdCell:function(e,a,t,n,r){$(e).addClass("img thin"),$(e).attr("nowrap","nowrap")},orderable:!1},{targets:1,render:function(e,a,t){return t[3]},orderable:!1},{targets:2,render:function(e,a,t){return t[4]&&t[4]>0?'<span data-livestamp="'+t[4]+'"></span><br><small class="text-muted">'+t[5]+"</small>":""},createdCell:function(e,a,t,n,r){$(e).addClass("thin"),$(e).attr("nowrap","nowrap")},orderable:!1}]},a=$("#recent-table"),t=a.gdbTable({tableOptions:e});websocketListener("chat-bot",function(n){const r=t.page.info();if(0===r.page){const t=JSON.parse(n.data);addDataTablesRow(e,t.Data.row_data,r.length,a)}})}$("#commands-docs").gdbTable({order:[[0,"asc"],[1,"asc"]],tableOptions:{drawCallback:function(e){const a=this.api();if(a.order()[0]&&0===a.order()[0][0]){const e=a.rows({page:"current"}).nodes();let t=null;a.rows().every(function(a,n,r){let s=this.data()[0].display;t!==s&&($(e).eq(r).before('<tr class="table-success"><td colspan="5">'+s+"</td></tr>"),t=s)})}}}}),loadAjaxOnObserve({chart:loadChart,"recent-table":loadLatest})}if($("#commits-page").length>0){const e=$("table.table");let a=null;const t={order:[[1,"desc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[3]),$(e).attr("data-target","_blank")},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[3]+'" target="_blank" class="icon-name"><div class="name">'+t[0]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).attr("id",t[4]),$(e).attr("nowrap","nowrap")},orderable:!1},{targets:1,render:function(e,a,t){return'<span data-toggle="tooltip" data-placement="left" title="'+t[2]+'" data-livestamp="'+t[1]+'"></span>'},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:2,render:function(e,a,t){return t[4]},orderable:!1},{targets:3,render:function(t,n,r){return null===a&&(a=e.DataTable().page.info().page),r[5]||a>0?'<i class="fas fa-check text-success"></i>':'<i class="fas fa-times text-danger"></i>'},orderable:!1}]};e.gdbTable({tableOptions:t}).on("draw.dt",function(e,t){a=null})}if($("#coop-page").length>0){const e=$("#ids"),a=$("#search");function loadCoopSearchTable(){const t={order:[[0,"asc"]],createdRow:function(e,a,t){$(e).attr("data-player-id",a[1])},language:{zeroRecords:function(){return'No matching players found on Global Steam. If a player is missing, <a href="/players/add?search='+a.val()+'">add them here</a>.'}},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[3]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[4]+'" alt="" data-lazy-alt="'+t[2]+'"></div><div class="name">'+t[10]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[0]?t[0].toLocaleString():$lockIcon},orderable:!1},{targets:2,render:function(e,a,t){return t[6]?t[6].toLocaleString():$lockIcon},orderable:!1},{targets:3,render:function(e,a,t){return t[8]?'<a href="'+t[7]+'" ><i class="fas fa-minus"></i> Remove</a>':'<a href="'+t[7]+'" ><i class="fas fa-plus"></i> Add</a>'},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:4,render:function(e,a,t){return t[5]?'<a href="'+t[5]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1},{targets:5,render:function(e,a,t){return t[9]},orderable:!1,visible:user.isLocal}]};$("#search-table").gdbTable({tableOptions:t,searchFields:[e,a]}).on("draw.dt",function(e,t){a.val()?$("#search-results").show():$("#search-results").hide()}),$("#players-table").gdbTable({tableOptions:t,searchFields:[e]})}function loadCoopGamesTable(){const a={order:[[0,"asc"]],createdRow:function(e,a,t){$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[7])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[7]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[2]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[3]},createdCell:function(e,a,t,n,r){$(e).addClass("platforms")},orderable:!1},{targets:2,render:function(e,a,t){return t[4].toLocaleString()},orderable:!1},{targets:3,render:function(e,a,t){return t[5]},orderable:!1},{targets:4,render:function(e,a,t){return t[6]?'<a href="'+t[6]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1}]};$("#games-table").gdbTable({tableOptions:a,searchFields:[e]})}loadCoopSearchTable(),loadCoopGamesTable()}const $xpPage=$("#experience-page");if($xpPage.length>0){function scroll(){if("string"==typeof scrollTo){const e=$(scrollTo).offset().top-100;$("html, body").animate({scrollTop:e},500),$("tr").removeClass("table-success"),$(scrollTo).addClass("table-success")}}function levelToXP(e){let a=0;for(let t=0;t<=e;t++)a+=100*Math.ceil(t/10);return a}function update(){const e=$("#answer");e.val("Loading..");let a=$("#from").val();a<1&&(a=1);let t=$("#to").val();t<1&&(t=1),e.val((levelToXP(t)-levelToXP(a)).toLocaleString())}$xpPage.on("click","tr[data-level]",function(e){const a=$(this).attr("data-level");history.pushState&&history.pushState("data","","/experience/"+a),scrollTo="tr[data-level="+a+"]",scroll()}),$("#from, #to").on("change",update),$("#calculate").on("click",function(e){e.preventDefault(),update()}),$(function(e){scroll(),update()})}if($("#donate-page").length>0){const e={order:[[1,"desc"]],createdRow:function(e,a,t){a[0]>0&&$(e).attr("data-link",a[2])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[2]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[3]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return"$"+t[5].toLocaleString()},orderable:!1}]};$("#top-donations").gdbTable({tableOptions:e}),$("#new-donations").gdbTable({tableOptions:e})}const $groupPage=$("#group-page");if($groupPage.length>0){function loadGroupPlayers(){const e={order:[[2,"desc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[3]),$(e).attr("data-app-id",a[0])},columnDefs:[{targets:0,render:function(e,a,t){if(t[6]){const e='<img data-lazy="'+t[4]+'" alt="" data-lazy-alt="'+t[6]+'" class="wide" data-toggle="tooltip" data-placement="left" data-lazy-title="'+t[6]+'">';return'<a href="/players?country='+t[6]+'">'+e+"</a>"}return""},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return'<a href="'+t[8]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[3]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1},{targets:2,render:function(e,a,t){return'<div class="icon-name"><div class="icon"><div class="'+t[7]+'"></div></div><div class="name min nowrap">'+t[5].toLocaleString()+"</div></div>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderSequence:["desc","asc"]},{targets:3,render:function(e,a,t){return t[9]?t[9].toLocaleString():$lockIcon},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderSequence:["desc","asc"]},{targets:4,render:function(e,a,t){return t[2]?'<a href="'+t[2]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1}]};$("#players").gdbTable({tableOptions:e,searchFields:[$("#items-search")]})}websocketListener("group",function(e){JSON.parse(e.data).Data.toString()===$groupPage.attr("data-id")&&toast(!0,"Click to refresh","This group has been updated",0,"refresh")}),loadAjaxOnObserve({"group-chart":function(){loadGroupChart($groupPage)},players:loadGroupPlayers})}function loadGroupChart(e){0!==$("#group-chart").length&&$.ajax({type:"GET",url:"/groups/"+e.attr("data-group-id")+"/members.json",dataType:"json",success:function(a,t,n){null===a&&(a=[]),Highcharts.chart("group-chart",$.extend(!0,{},defaultChartOptions,{xAxis:{plotLines:plotline(e.attr("data-release"),"Steam Release")},yAxis:[{allowDecimals:!1,title:{text:""},labels:{formatter:function(){return this.value.toLocaleString()}},opposite:!1},{allowDecimals:!1,title:{text:""},labels:{formatter:function(){return this.value.toLocaleString()}},opposite:!0}],tooltip:{formatter:function(){switch(this.series.name){case"In Chat":return this.y.toLocaleString()+" members in chat on "+moment(this.key).format("dddd DD MMM YYYY");case"In Game":return this.y.toLocaleString()+" members in game on "+moment(this.key).format("dddd DD MMM YYYY");case"Online":return this.y.toLocaleString()+" members online "+moment(this.key).format("dddd DD MMM YYYY");case"Members":return this.y.toLocaleString()+" members on "+moment(this.key).format("dddd DD MMM YYYY")}}},series:[{name:"In Chat",color:"#007bff",data:a.max_members_in_chat,marker:{symbol:"circle"},yAxis:1},{name:"In Game",color:"#e83e8c",data:a.max_members_in_game,marker:{symbol:"circle"},yAxis:1,visible:!1},{name:"Members",color:"#28a745",data:a.max_members_count,marker:{symbol:"circle"},yAxis:0}]}))}})}if($("#groups-page").length>0){$("select.form-control-chosen").chosen({disable_search_threshold:5,allow_single_deselect:!0,max_selected_options:1});const e={order:[[3,"desc"]],createdRow:function(e,a,t){$(e).attr("data-group-id",a[0]),$(e).attr("data-link",a[10])},columnDefs:[{targets:0,render:function(e,a,t){return t[9].toLocaleString()},orderable:!1},{targets:1,render:function(e,a,t){let n=t[12]+"<br><small>"+t[4]+"</small>";return t[8]&&(n+='<span class="badge badge-danger float-right">Removed</span>'),'<a href="'+t[10]+'" class="icon-name"><div class="icon"><img class="tall" data-src="/assets/img/no-app-image-square.jpg" data-lazy="'+t[5]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+n+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1},{targets:2,render:function(e,a,t){return t[13].toLocaleString()},orderSequence:["desc"]},{targets:3,render:function(e,a,t){return t[6].toLocaleString()},orderSequence:["desc"]},{targets:4,render:function(e,a,t){return t[7]},orderSequence:["desc","asc"]},{targets:5,render:function(e,a,t){return t[2]?'<a href="'+t[2]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1},{targets:6,render:function(e,a,t){return t[11]},orderable:!1,visible:user.isLocal}]};$("table.table").gdbTable({tableOptions:e,searchFields:[$("#search"),$("#filter")]})}const $homePage=$("#home-page");if($homePage.length>0){$homePage.on("click","#sales span[data-sort]:not(.badge-success)",function(e){loadSales($(this).attr("data-sort"))}),$homePage.on("click","#top-players span[data-sort]:not(.badge-success)",function(e){homeTopPlayers($(this).attr("data-sort"))});let e=0;const a=$("#panels .card");function loadHomeTweets(){$.ajax({url:"/home/tweets.json",dataType:"json",cache:!0,success:function(e,a,t){if(isIterable(e)){$("#tweets .card-body").empty().json2html(e,{"<>":"div",class:"tweet",html:[{"<>":"img",src:"${image}",alt:"${text}"},{"<>":"p",html:'<i class="fas fa-star text-warning"></i> ${text}'}]},{prepend:!1})}}})}function loadNewsSection(){const e=$("#news .card-body");$.ajax({type:"GET",url:"/home/news.html",dataType:"html",success:function(a,t,n){a&&(e.html(a),observeLazyImages(e.find("img[data-lazy]")))}})}function homeNewPlayers(){let e=0;const a=$("#new-players tbody"),t=function(e,a){return{"<>":"tr",class:e?"fade-green":"","data-app-id":"${id}","data-link":"${link}",html:[{"<>":"td",class:"img",html:[{"<>":"a",href:"${link}",class:"icon-name",html:[{"<>":"div",class:"icon",html:[{"<>":"img","data-lazy":"${avatar}",alt:"","data-lazy-alt":"${name}"}]},{"<>":"div",class:"name",html:"${name}"}]}]},{"<>":"td",nowrap:"nowrap",html:[{"<>":"span","data-livestamp":"${created_at}",text:a?"a few seconds ago":""}]},{"<>":"td",html:[{"<>":"a",href:"${community_link}",target:"_blank",rel:"noopener",html:[{"<>":"i",class:"fas fa-link"}]}]}]}};$.ajax({url:"/home/new-players.json",dataType:"json",cache:!0,success:function(n,r,s){isIterable(n)&&(a.find("tr").remove(),a.json2html(n,t(!1,!1),{prepend:!1}),observeLazyImages(a.find("img[data-lazy]"))),e=n[0].id}}),websocketListener("profile",function(n){const r=JSON.parse(n.data);"player"===r.Data.queue&&r.Data.id!==e&&r.Data.new&&(e=r.Data.id,a.json2html([r.Data],t(!0,!0),{prepend:!0}),a.find("tr").slice(10).remove(),observeLazyImages(a.find("img[data-lazy]")))})}function loadSales(e){$.ajax({url:"/home/sales/"+e+".json",dataType:"json",cache:!0,success:function(a,t,n){const r=$("#sales span[data-sort]");r.removeClass("badge-success"),r.addClass("cursor-pointer");const s=$('#sales span[data-sort="'+e+'"]');if(s.addClass("badge-success"),s.removeClass("cursor-pointer"),$("#sales tbody tr").remove(),$("#sales .change").html(e),isIterable(a)){const e=$("#sales tbody");e.json2html(a,{"<>":"tr","data-app-id":"${id}","data-link":"${link}",html:[{"<>":"td",class:"img",html:[{"<>":"a",href:"${link}",class:"icon-name",html:[{"<>":"div",class:"icon",html:[{"<>":"img","data-lazy":"${icon}",alt:"","data-lazy-alt":"${name}"}]},{"<>":"div",class:"name",html:"${name}"}]}]},{"<>":"td",html:"${price}",class:"nowrap"},{"<>":"td",html:"${rating}"},{"<>":"td",nowrap:"nowrap",class:"nowrap",html:[{"<>":"span","data-toggle":"tooltip","data-placement":"left","data-livestamp":"${ends}"}]},{"<>":"td",html:[{"<>":"a",href:"${store_link}",target:"_blank",rel:"noopener",html:[{"<>":"i",class:"fas fa-link"}]}]}]},{prepend:!1}),observeLazyImages(e.find("img[data-lazy]")),highLightOwnedGames($("#sales"))}}})}function homeTopPlayers(e){$.ajax({url:"/home/top-players/"+e+".json",dataType:"json",cache:!0,success:function(a,t,n){const r=$("#top-players span[data-sort]");r.removeClass("badge-success"),r.addClass("cursor-pointer");const s=$('#top-players span[data-sort="'+e+'"]');if(s.addClass("badge-success"),s.removeClass("cursor-pointer"),$("#top-players tbody tr").remove(),isIterable(a)){const t=$("#top-players tbody"),n=[{"<>":"td",class:"font-weight-bold",html:"${rank}"},{"<>":"td",class:"img",html:[{"<>":"a",href:"${link}",class:"icon-name",html:[{"<>":"div",class:"icon",html:[{"<>":"img","data-lazy":"${avatar}",alt:"","data-lazy-alt":"${name}"}]},{"<>":"div",class:"name",html:"${name}"}]}]}],r=$("#top-players .change1"),s=$("#top-players .change2");switch(e){case"level":n.push({"<>":"td",class:"img",html:'<div class="icon-name"><div class="icon"><div class="${class}"></div></div><div class="name min nowrap">${level}</div></div>'}),n.push({"<>":"td",nowrap:"nowrap",html:"${badges}"}),r.html("Level"),s.html("Badges");break;case"games":n.push({"<>":"td",nowrap:"nowrap",html:"${games}"}),n.push({"<>":"td",nowrap:"nowrap",html:"${playtime}"}),r.html("Games"),s.html("Playtime");break;case"bans":n.push({"<>":"td",nowrap:"nowrap",html:"${game_bans}"}),n.push({"<>":"td",nowrap:"nowrap",html:"${vac_bans}"}),r.html("Game Bans"),s.html("VAC Bans");break;case"profile":n.push({"<>":"td",nowrap:"nowrap",html:"${friends}"}),n.push({"<>":"td",nowrap:"nowrap",html:"${comments}"}),r.html("Friends"),s.html("Comments");break;case"awards":n.push({"<>":"td",nowrap:"nowrap",html:"${awards_sent}"}),n.push({"<>":"td",nowrap:"nowrap",html:"${awards_received}"}),r.html("Given"),s.html("Received")}t.json2html(a,{"<>":"tr","data-link":"${link}",html:n},{prepend:!1}),observeLazyImages(t.find("img[data-lazy]"))}}})}a.each(function(){$(this).height()>e&&(e=$(this).height())}),a.css("min-height",e+"px"),loadAjaxOnObserve({"top-players":function(){homeTopPlayers("level")},"new-players":homeNewPlayers,"upcoming-games":homeUpcomingGames,"new-releases":homeNewReleases,news:loadNewsSection,tweets:loadHomeTweets});const t=$.extend(!0,{},defaultChartOptions,{yAxis:{allowDecimals:!1,title:{text:""},labels:{formatter:function(){return this.value.toLocaleString()}},gridLineColor:darkMode?"#00ff0011":"#44774411"},plotOptions:{series:{cursor:"pointer"}},legend:{enabled:!1}});function homeNewReleases(){$.ajax({type:"GET",url:"/home/new-releases.json",dataType:"json",cache:!0,success:function(e,a,n){let r=[];for(const a of e.players){const t=e.apps[a.key];r.push({app:a.key,name:t.name,data:a.value.max_moving_average,connectNulls:!0})}const s=Highcharts.chart("new-releases",$.extend(!0,{},t,{plotOptions:{series:{point:{events:{click:function(){location.href=e.apps[this.series.userOptions.id].path}}}}},tooltip:{formatter:function(){return this.series.name+" had "+this.y.toLocaleString()+" players on "+moment(this.key).format("dddd DD MMM YYYY @ HH:00")}},series:r})),o=$("#new-releases-legend");$.each(s.series,function(a,t){const n=e.apps[t.userOptions.app];o.append('<div class="cursor-pointer" style="color:'+t.color+'" data-link="'+n.path+'"><img class="rounded" src="'+n.icon+'" alt="'+t.name+'"> '+t.name+"</div>")}),homeAttachLegendEvents(s,o,e)}})}function homeUpcomingGames(){$.ajax({type:"GET",url:"/home/upcoming-games.json",dataType:"json",cache:!0,success:function(e,a,n){let r=[];for(const a of e.followers){const t=e.apps[a.key];r.push({group:t.group,name:t.name,data:a.value.max_members_count,connectNulls:!0,date:t.date})}const s=Highcharts.chart("upcoming-games",$.extend(!0,{},t,{plotOptions:{series:{point:{events:{click:function(){location.href=e.apps[this.series.userOptions.group].path}}}}},tooltip:{formatter:function(){return this.series.name+" had "+this.y.toLocaleString()+" followers on "+moment(this.key).format("dddd DD MMM")}},series:r})),o=$("#upcoming-games-legend");$.each(s.series,function(a,t){const n=e.apps[t.userOptions.group];o.append('<div class="cursor-pointer" style="color:'+t.color+'" data-link="'+n.path+'" data-toggle="tooltip" data-placement="top" title="'+n.date+'"><img class="rounded" src="'+n.icon+'" alt="'+t.name+'"> '+t.name+"</div>")}),homeAttachLegendEvents(s,o,null)}})}function homeAttachLegendEvents(e,a,t){a.on("mouseenter","div",function(){if(t){let a=0;t.players[$(this).index()].value.max_player_count.forEach(function(e){a=Math.max(a,e[1])}),e.yAxis[0].update({max:a})}$.each(e.series,function(a,t){e.series[a].setState("inactive")}),e.series[$(this).index()].setState("hover")}).on("mouseleave","div",function(){t&&e.yAxis[0].update({max:null}),$.each(e.series,function(a,t){e.series[a].setState("normal")})})}}if($("#info-page").length>0&&$("#questions "+window.location.hash).addClass("highlight"),$("#news-page").length>0){$("select.form-control-chosen").chosen({disable_search_threshold:5,allow_single_deselect:!0,max_selected_options:10});const e={order:[[1,"desc"]],createdRow:function(e,a,t){$(e).attr("data-app-id",a[3]),$(e).attr("data-article-id",a[0]),$(e).attr("data-time",a[5]),$(e).addClass("cursor-pointer")},columnDefs:[{targets:0,render:function(e,a,t){const n=t[10]+'<br><small><a href="'+t[8]+'">'+t[7]+"</a> - "+t[11]+"</small>";return'<div class="icon-name"><div class="icon"><img class="tall" alt="" src="" data-lazy="'+t[4]+'" data-lazy-alt="'+t[1]+'"></div><div class="name">'+n+"</div></div>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return'<span data-toggle="tooltip" data-placement="left" data-livestamp="'+t[5]+'"></span><br><small class="text-muted">'+t[9]+"</small>"},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["desc"]},{targets:2,render:function(e,a,t){return t[6]},orderable:!1,visible:user.isLocal}]},a=$("#news-table"),t=a.gdbTable({searchFields:[$("#filter"),$("#feed"),$("#search")],tableOptions:e});a.on("click","tbody tr[role=row]",function(){const e=$(this),a=t.row(e);a.child.isShown()?(a.child.hide(),e.removeClass("shown")):(a.child($("<div/>").html(a.data()[2])).show(),e.addClass("shown"),observeLazyImages($(this).next().find("img[data-lazy]")))}),a.on("draw.dt",function(e,a){const t=window.location.hash;if(t){const e=$("tr[data-article-id="+t.replace("#","")+"]");e.length>0&&(e.trigger("click"),$("html, body").animate({scrollTop:e.offset().top-100},200),history.replaceState(null,null," "))}}),a.on("click","a",function(e){e.stopPropagation()})}const $packagePage=$("#package-page");if($packagePage.length>0&&($('a[data-toggle="tab"]').on("shown.bs.tab",function(e){const a=$(e.target);$(e.relatedTarget);if(!a.attr("loaded"))switch(a.attr("loaded",1),a.attr("href")){case"#prices":loadPriceChart()}}),websocketListener("package",function(e){JSON.parse(e.data).Data.toString()===$packagePage.attr("data-id")&&toast(!0,"Click to refresh","This package has been updated",0,"refresh")})),$("#new-releases-page").length>0){const e={order:[[3,"desc"]],createdRow:function(e,a,t){$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[3])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[3]+'" class="icon-name"><div class="icon"><img alt="" data-lazy="'+t[2]+'" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[5]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:2,render:function(e,a,t){return t[7]+"%"},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:3,render:function(e,a,t){return t[8].toLocaleString()},orderSequence:["desc","asc"]},{targets:4,render:function(e,a,t){return t[6]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:5,render:function(e,a,t){return'<div data-app-id="'+t[0]+'"><i class="fas fa-spinner fa-spin"></i></div>'},createdCell:function(e,a,t,n,r){$(e).addClass("chart")},orderSequence:["desc","asc"]}]};$("table.table").gdbTable({tableOptions:e,searchFields:[$("#search"),$("#days")]})}if($("#packages-page").length>0){$("select.form-control-chosen").chosen({disable_search_threshold:5,allow_single_deselect:!0,max_selected_options:10});const e={order:[[5,"desc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[1])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[1]+'" class="icon-name"><div class="icon"><img alt="" data-lazy="'+t[8]+'" data-lazy-alt="'+t[2]+'"></div><div class="name">'+t[2]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return user.prodCC in t[5]?t[5][user.prodCC]:"-"},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:2,render:function(e,a,t){return user.prodCC in t[9]?t[9][user.prodCC]:"0%"},orderSequence:["desc","asc"]},{targets:3,render:function(e,a,t){return t[4].toLocaleString()},orderSequence:["desc","asc"]},{targets:4,render:function(e,a,t){return t[11]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:5,render:function(e,a,t){return'<span data-toggle="tooltip" data-placement="left" title="'+t[7]+'" data-livestamp="'+t[6]+'">'+t[7]+"</span>"},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["desc"]},{targets:6,render:function(e,a,t){return t[10]?'<a href="'+t[10]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1}]},a=[$("#status"),$("#platform"),$("#license"),$("#billing")],t=$("table.table"),n=t.gdbTable({tableOptions:e,searchFields:a});websocketListener("packages",function(a){const r=n.page.info();if(0===r.page){const n=JSON.parse(a.data);addDataTablesRow(e,n.Data,r.length,t)}})}const $playerMissingPage=$("#player-missing-page");if($playerMissingPage.length>0){function updateLoadingBar(){if(queue_current>0){let e=0;queue_start>0&&(e=100-queue_current/queue_start*100),e<5&&(e=5),$(".progress .progress-bar").html(ordinal(queue_current)).width(e+"%")}else $(".progress .progress-bar").html("You're Next!").width("100%")}websocketListener("profile",function(e){queue_current>0&&queue_current--,updateLoadingBar();const a=JSON.parse(e.data);"player"===a.Data.queue&&a.Data.id===$playerMissingPage.attr("data-id")&&(toast(!0,"","Player found!"),location.reload())}),updateLoadingBar()}if($("#players-page").length>0){const e=$("#search"),a=$("#country"),t=$("#state"),n=$("#state-container");function toggleStateDropDown(){const e=a.val();e.startsWith("c-")?n.hide():$.ajax({type:"GET",url:"/players/states.json?cc="+e,dataType:"json",success:function(e,a,r){!e||e.length<=3?n.hide():(t.empty(),$.each(e,function(e,a){let n={value:a.k,text:a.v};"---"===a.v&&(n.disabled="disabled"),t.append($("<option/>",n))}),t.val(""),n.show(),t.trigger("chosen:updated"))}})}$("select.form-control-chosen").chosen({disable_search_threshold:5,allow_single_deselect:!0,max_selected_options:1}),a.on("change",function(e){toggleStateDropDown()});const r={language:{zeroRecords:function(){return'Players can be searched for using their username or vanity URL. If a player is missing, <a href="/players/add?search='+e.val()+'">add them here</a>.'}},order:[getOrder(window.location.hash)],createdRow:function(e,a,t){$(e).attr("data-link",a[13])},columnDefs:[{targets:0,render:function(e,a,t){return t[0]},createdCell:function(e,a,t,n,r){$(e).addClass("font-weight-bold")},orderable:!1},{targets:1,render:function(e,a,t){if(t[11]){const e='<img data-lazy="'+t[11]+'" alt="" data-lazy-alt="'+t[12]+'" class="wide" data-toggle="tooltip" data-placement="left" data-lazy-title="'+t[12]+'">';return'<a href="/players?country='+t[19]+'">'+e+"</a>"}return""},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1},{targets:2,render:function(e,a,t){return'<a href="'+t[13]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[3]+'" alt="" data-lazy-alt="'+t[2]+'"></div><div class="name">'+t[23]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1},{targets:3,render:function(e,a,t){return'<div class="icon-name"><div class="icon"><div class="'+t[4]+'"></div></div><div class="name min nowrap">'+t[5].toLocaleString()+"</div></div>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderSequence:["desc"]},{targets:4,render:function(e,a,t){return t[7].toLocaleString()},orderSequence:["desc"]},{targets:5,render:function(e,a,t){return t[6]?t[6].toLocaleString():$lockIcon},orderSequence:["desc"]},{targets:6,render:function(e,a,t){return"-"===t[8]?$lockIcon:t[8]},createdCell:function(e,a,t,n,r){if("-"!==t[8]){const a=$(e);a.attr("nowrap","nowrap"),a.attr("data-toggle","tooltip"),a.attr("data-placement","left"),a.attr("title",t[9])}},orderSequence:["desc"]},{targets:7,render:function(e,a,t){return t[15].toLocaleString()},orderSequence:["desc"]},{targets:8,render:function(e,a,t){return t[16].toLocaleString()},orderSequence:["desc"]},{targets:9,render:function(e,a,t){return t[17]>0?'<span data-toggle="tooltip" data-placement="left" title="'+t[18]+'" data-livestamp="'+t[17]+'"></span>':""},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["desc"]},{targets:10,render:function(e,a,t){return t[21].toLocaleString()},orderSequence:["desc"]},{targets:11,render:function(e,a,t){return t[22].toLocaleString()},orderSequence:["desc"]},{targets:12,render:function(e,a,t){return t[25].toLocaleString()},orderSequence:["desc"]},{targets:13,render:function(e,a,t){return t[26].toLocaleString()},orderSequence:["desc"]},{targets:14,render:function(e,a,t){return t[27].toLocaleString()},orderSequence:["desc"]},{targets:15,render:function(e,a,t){return t[28].toLocaleString()},orderSequence:["desc"]},{targets:16,render:function(e,a,t){return t[29].toLocaleString()},orderSequence:["desc"]},{targets:17,render:function(e,a,t){return t[14]?'<a href="'+t[14]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1},{targets:18,render:function(e,a,t){return t[24]},orderable:!1,visible:user.isLocal}]};let s=[a,e,t];const o=$("table.table").gdbTable({tableOptions:r,searchFields:s});function getOrder(a){const t=$("[data-col-sort]").attr("data-col-sort");if(e.val()&&t)return[parseInt(t),"desc"];switch(a){case"#games":return[5,"desc"];case"#bans":return[7,"desc"];case"#achievements":return[10,"desc"];case"#awards":return[13,"desc"];default:return[3,"desc"]}}function updateColumns(e,a){a||(a="#level"),$('#player-nav a[href="'+a+'"]').tab("show");let t=[],n=[];switch(a){case"#level":n=[3,4,12],t=[5,6,7,8,9,10,11,13,14,15,16];break;case"#games":n=[5,6],t=[3,4,7,8,9,10,11,12,13,14,15,16];break;case"#bans":n=[7,8,9],t=[3,4,5,6,10,11,12,13,14,15,16];break;case"#achievements":n=[10,11],t=[3,4,5,6,7,8,9,12,13,14,15,16];break;case"#awards":n=[13,14,15,16],t=[3,4,5,6,7,8,9,10,11,12]}e.columns(t).visible(!1,!1),e.columns(n).visible(!0,!1),e.columns.adjust(),JSON.stringify(e.order())!==JSON.stringify([getOrder(a)])&&(e.order([getOrder(a)]),e.draw());const r=e.table().container();observeLazyImages($(r).find("img[data-lazy]"))}$('#player-nav a[href^="#"]').on("click",function(e){e.preventDefault();const a=$(this).attr("href");window.location.hash=a,updateColumns(o,a)}),updateColumns(o,window.location.hash),toggleStateDropDown()}const $playerPage=$("#player-page");if($playerPage.length>0){const e=$("#update-button");e.on("click",function(a){a.preventDefault(),$("i, svg",e).addClass("fa-spin"),$.ajax({url:"/players/"+$playerPage.attr("data-id")+"/update.json",data:{csrf:$(this).attr("data-csrf")},dataType:"json",cache:!1,success:function(a,t,n){toast(a.success,a.toast),e.contents().last()[0].textContent=" In Queue"}})});let a;function loadPlayerLibraryTab(){const e={order:[[2,"desc"]],createdRow:function(e,a,t){$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[7])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[7]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[2]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderSequence:["asc","desc"]},{targets:1,render:function(e,a,t){return t[5]},orderSequence:["desc","asc"]},{targets:2,render:function(e,a,t){return t[4]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:3,render:function(e,a,t){return t[6]},orderSequence:["desc","asc"]},{targets:4,render:function(e,a,t){return t[9]>0?t[8].toLocaleString()+" / "+t[9].toLocaleString():"-"},createdCell:function(e,a,t,n,r){t[10]=Math.ceil(t[10]),$(e).css("background","linear-gradient(to right, rgba(0,0,0,.15) "+t[10]+"%, transparent "+t[10]+"%)"),$(e).addClass("thin")},orderSequence:["desc","asc"]}]};$("#all-games").gdbTable({tableOptions:e,searchFields:[$("#player-games-search")]})}function loadPlayerLibraryStatsTab(){const e={order:[[1,"desc"]],createdRow:function(e,a,t){$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[5])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[5]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[1]+'" alt="" data-lazy-alt="'+t[2]+'"></div><div class="name">'+t[2]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")}},{targets:1,render:function(e,a,t){return t[3].toLocaleString()}},{targets:2,render:function(e,a,t){return t[4].toLocaleString()},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")}}]};$("#recent-games").gdbTable({tableOptions:e})}function loadPlayerHistory(){$.ajax({type:"GET",url:"/players/"+$playerPage.attr("data-id")+"/history.json",dataType:"json",success:function(e,a,t){null===e&&(e={});const n={l:[{name:"Level",data:e.max_level,marker:{symbol:"circle"},yAxis:0},{name:"Level Rank",data:e.max_level_rank,marker:{symbol:"circle"},yAxis:1}],b:[{name:"Badges",data:e.max_badges,marker:{symbol:"circle"},yAxis:0},{name:"Badges Rank",data:e.max_badges_rank,marker:{symbol:"circle"},yAxis:1}],d:[{name:"Foil Badges",data:e.max_badges_foil,marker:{symbol:"circle"},yAxis:0},{name:"Foil Badges Rank",data:e.max_badges_foil_rank,marker:{symbol:"circle"},yAxis:1}],g:[{name:"Games",data:e.max_games,marker:{symbol:"circle"},yAxis:0},{name:"Games Rank",data:e.max_games_rank,marker:{symbol:"circle"},yAxis:1}],p:[{name:"Playtime",data:e.max_playtime,marker:{symbol:"circle"},yAxis:0},{name:"Playtime Rank",data:e.max_playtime_rank,marker:{symbol:"circle"},yAxis:1}],a:[{name:"Achievements",data:e.max_achievements,marker:{symbol:"circle"},yAxis:0},{name:"Achievements Rank",data:e.max_achievements_rank,marker:{symbol:"circle"},yAxis:1}],c:[{name:"Awards Given",data:e.max_awards_given_points,marker:{symbol:"circle"},yAxis:0},{name:"Awards Given Rank",data:e.max_awards_given_points_rank,marker:{symbol:"circle"},yAxis:1}],e:[{name:"Awards Received",data:e.max_awards_received_points,marker:{symbol:"circle"},yAxis:0},{name:"Awards Received Rank",data:e.max_awards_received_points_rank,marker:{symbol:"circle"},yAxis:1}]};for(let e in n){const a=e+"-chart";n.hasOwnProperty(e)?Highcharts.chart(a,$.extend(!0,{},defaultChartOptions,{legend:{enabled:!1},yAxis:[{labels:{enabled:!1}},{allowDecimals:!1,title:{text:""},reversed:!0,min:1}],tooltip:{outside:!0,formatter:function(){switch(!0){case"Playtime"===this.series.name:return this.y.toLocaleString()+" minutes played on "+moment(this.key).format("dddd DD MMM YYYY");case this.series.name.endsWith("Rank"):return ordinal(this.y)+" "+this.series.name+" on "+moment(this.key).format("dddd DD MMM YYYY");default:return this.y.toLocaleString()+" "+this.series.name+" on "+moment(this.key).format("dddd DD MMM YYYY")}}},series:n[e]})):$(a).empty()}}})}function loadPlayerBadgesTab(){const e={order:[[1,"desc"]],createdRow:function(e,a,t){a[0]&&$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[2])},columnDefs:[{targets:0,render:function(e,a,t){let n=t[1];return t[9]&&(n+='<span class="badge badge-primary float-right ml-1">Special</span>'),t[10]&&(n+='<span class="badge badge-warning float-right ml-1">Event</span>'),t[4]&&(n+='<span class="badge badge-success float-right ml-1">Foil</span>'),'<a href="'+t[2]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[5]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+n+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[6].toLocaleString()+" ("+t[8].toLocaleString()+"xp)"},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:2,render:function(e,a,t){return t[7].toLocaleString()},orderSequence:["asc","desc"]},{targets:3,render:function(e,a,t){return t[3].toLocaleString()},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]}]};$("#badges-table").gdbTable({tableOptions:e,searchFields:[$("#player-badge-search")]})}function loadPlayerFriendsTab(){const e={order:[[1,"desc"],[4,"asc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[1])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[1]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[2]+'" data-src="/assets/img/no-player-image.jpg" alt="" data-lazy-alt="'+t[3]+'"></div><div class="name">'+t[3]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return""!==t[4]&&"-"!==t[4]||$("#add-missing-friends").removeClass("d-none"),t[4]?t[4].toLocaleString():$lockIcon},orderSequence:["desc","asc"]},{targets:2,render:function(e,a,t){return t[5]?0===t[6]?$lockIcon:t[6].toLocaleString():"-"},orderSequence:["desc","asc"]},{targets:3,render:function(e,a,t){return t[6]>0?'<a href="/games/coop/'+$playerPage.attr("data-id")+","+t[0]+'">Co-op</a>':""},orderable:!1},{targets:4,render:function(e,a,t){return t[7]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["asc","desc"]},{targets:5,render:function(e,a,t){return t[8]?'<a href="'+t[8]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1}]};$("#friends-table").gdbTable({tableOptions:e})}function loadPlayerGroupsTab(){const e={order:[[1,"desc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[3]),$(e).attr("data-group-id",a[0])},columnDefs:[{targets:0,render:function(e,a,t){let n="";return t[7]&&(n='<span class="badge badge-success float-right">Primary</span>'),'<a href="'+t[3]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[4]+'" data-src="/assets/img/no-player-image.jpg" alt="" data-lazy-alt="'+t[2]+'"></div><div class="name">'+t[2]+n+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderSequence:["asc"]},{targets:1,render:function(e,a,t){return t[5].toLocaleString()},orderSequence:["desc","asc"]},{targets:2,render:function(e,a,t){return"game"===t[6]?'<i class="fas fa-gamepad text-primary"></i> Game':"group"===t[6]?'<i class="fas fa-user-friends text-success"></i> Group':""},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:3,render:function(e,a,t){return t[8]?'<a href="'+t[8]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1}]};$("#groups-table").gdbTable({tableOptions:e})}function loadPlayerWishlistTab(){const e={order:[[0,"asc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[2])},columnDefs:[{targets:0,render:function(e,a,t){return 0===t[4]?"-":ordinal(t[4])},createdCell:function(e,a,t,n,r){$(e).addClass("font-weight-bold")},orderSequence:["asc"]},{targets:1,render:function(e,a,t){return'<a href="'+t[2]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[3]+'" data-src="/assets/img/no-player-image.jpg" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderSequence:["asc"]},{targets:2,render:function(e,a,t){return t[5]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:3,render:function(e,a,t){return t[6]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:4,render:function(e,a,t){return t[7]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]}]};$("#wishlist-table").gdbTable({tableOptions:e})}function loadPlayerAchievementsTab(){$.ajax({type:"GET",url:"/players/"+$playerPage.attr("data-id")+"/achievement-days.json",dataType:"json",success:function(e,a,t){null===e&&(e=[]),$("#achievement-days-chart").empty().calmosaic(e)}});const e={order:[[1,"desc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[0]+"#achievements")},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[0]+'#achievements" class="icon-name"><div class="icon"><img class="tall" data-lazy="'+t[4]+'" alt="" data-lazy-alt="'+t[3]+'"></div><div class="name">'+t[1]+": "+t[3]+"<br><small>"+t[5]+"</small></div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[6]?'<span data-livestamp="'+t[6]+'"></span><br><small class="text-muted">'+t[8]+"</small>":"Unknown"},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:2,render:function(e,a,t){return t[7]+"%"},createdCell:function(e,a,t,n,r){t[7]=Math.ceil(t[7]),$(e).css("background","linear-gradient(to right, rgba(0,0,0,.15) "+t[7]+"%, transparent "+t[7]+"%)"),$(e).addClass("thin")},orderSequence:["asc","desc"]}]};$("#achievements-table").gdbTable({tableOptions:e})}function loadPlayerAchievementsInfluxChart(){$.ajax({type:"GET",url:"/players/"+$playerPage.attr("data-id")+"/achievement-influx.json",dataType:"json",success:function(e,a,t){null===e&&(e=[]),Highcharts.chart("achievement-influx-chart",$.extend(!0,{},defaultChartOptions,{yAxis:{allowDecimals:!1,title:{text:"Achievements"},labels:{formatter:function(){return this.value.toLocaleString()}}},tooltip:{formatter:function(){switch(this.series.name){case"Achievements":return this.y.toLocaleString()+" achievements on "+moment(this.key).format("dddd DD MMM YYYY");case"Games with Achievements":return this.y.toLocaleString()+" games with achievements on "+moment(this.key).format("dddd DD MMM YYYY");case"Games with 100%":return this.y.toLocaleString()+" games with 100% achievements on "+moment(this.key).format("dddd DD MMM YYYY")}}},series:[{name:"Achievements",data:e.max_achievements,marker:{symbol:"circle"}},{name:"Games with Achievements",data:e.max_achievements_count_apps,marker:{symbol:"circle"}},{name:"Games with 100%",data:e.max_achievements_count_100,marker:{symbol:"circle"}}]}))}})}websocketListener("profile",async function(t){if(isMobile())return;const n=JSON.parse(t.data);if(n.Data.id===$playerPage.attr("data-id")){if("player"===n.Data.queue){a=toast(!0,'<ul><li data-queue="player">Details</li><li data-queue="achievement">Achievements</li><li data-queue="alias">Aliases</li><li data-queue="award">Awards</li><li data-queue="badge">Badges</li><li data-queue="game">Games</li><li data-queue="group">Groups</li><li data-queue="wishlist">Wishlist</li></ul><p><a href="/queues">Queues</a></p>',"Player Updating",-1,"refresh")}a&&(a.find('[data-queue="'+n.Data.queue+'"]').addClass("line-through"),0===a.find("li:not(.line-through)").length&&(a.find(".toast-title").html("Player Updated"),a.find(".toast-message").html("Click to refresh!"))),$("i, svg",e).removeClass("fa-spin","fa-sync-alt").addClass("fa-check"),e.contents().last()[0].textContent=" Updated",e.off(),e.removeAttr("href")}}),loadAjaxOnObserve({"all-games":loadPlayerLibraryTab,"recent-games":loadPlayerLibraryStatsTab,details:loadPlayerHistory,"badges-table":loadPlayerBadgesTab,"friends-table":loadPlayerFriendsTab,"groups-table":loadPlayerGroupsTab,"wishlist-table":loadPlayerWishlistTab,"achievements-table":loadPlayerAchievementsTab,"achievement-influx-chart":loadPlayerAchievementsInfluxChart})}const $priceChangesPage=$("#price-changes-page");if($priceChangesPage.length>0){const e=parseInt($priceChangesPage.attr("data-top-price"));$("select.form-control-chosen").chosen({disable_search_threshold:5,allow_single_deselect:!0,max_selected_options:10});const a=$("#change-low").val(),t=$("#change-high").val(),n=$("#change-slider"),r=noUiSlider.create(n[0],{start:[parseInt(a||-100),parseInt(t||100)],connect:!0,step:1,range:{min:-100,max:100}}),s=$("#price-low").val(),o=$("#price-high").val(),l=$("#price-slider"),i=noUiSlider.create(l[0],{start:[parseInt(s||0),parseInt(o||e)],connect:!0,step:1,range:{min:0,max:e}});function updateLabels(a){const t=r.get();t[0]===t[1]?$("label#change-label").html("Price Change Percent ("+Math.round(t[0])+"%)"):$("label#change-label").html("Price Change Percent ("+Math.round(t[0])+"% - "+Math.round(t[1])+"%)");const n=i.get();let s=Math.round(n[0]);s=s===e?e+"+":s;let o=Math.round(n[1]);o=o===e?e+"+":o,n[0]===n[1]?$("label#price-label").html("Final Price ("+user.userCurrencySymbol+s+")"):$("label#price-label").html("Final Price ("+user.userCurrencySymbol+s+" - "+user.userCurrencySymbol+o+")")}window.updateLabels=updateLabels,$(updateLabels),$typeField=$("#type");const c={order:[[4,"desc"]],createdRow:function(e,a,t){let n;$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[5]),a[9]?(n=Math.min(a[9],100),n+=100,n/=2):n=100,$(e).addClass("col-grad-"+Math.round(n))},columnDefs:[{targets:0,render:function(e,a,t){let n=t[3];return"all"===$typeField.val()&&(t[0]>0?n+=' <span class="badge badge-success float-right">App</span>':t[1]>0&&(n+=' <span class="badge badge-success float-right">Package</span>')),'<a href="'+t[5]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[4]+'" alt="" data-lazy-alt="'+t[3]+'"></div><div class="name">'+n+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[6]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:2,render:function(e,a,t){return t[7]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:3,render:function(e,a,t){const n="<small>"+t[9]+"%</small>";return 0===t[9]?t[8]+" <small>∞%</small> ":t[8]+" "+n},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:4,render:function(e,a,t){return'<span data-toggle="tooltip" data-placement="left" title="'+t[10]+'" data-livestamp="'+t[11]+'">'+t[10]+"</span>"},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1}]},d=[$typeField,n,l],u=serialiseTable(d,c.order),p=$("table.table"),m=p.gdbTable({tableOptions:c,searchFields:d});websocketListener("prices",function(e){let a=!1;if(Object.toJSON(u)===Object.toJSON(serialiseTable(d,m.order()))){const t=m.page.info();if(0===t.page){a=!0;const n=JSON.parse(e.data);if(n.Data[13]===user.prodCC)return void addDataTablesRow(c,n.Data,t.length,p)}}a||toast(!0,"Reset table filters/sorting/page to show live","New Price Change")})}if($("#product-keys-page").length>0){const e=$("#type"),a=$("#key"),t=$("#comparator"),n=$("#value");e.chosen({allow_single_deselect:!1,disable_search_threshold:10}),a.chosen({allow_single_deselect:!1}),t.chosen({allow_single_deselect:!0,disable_search_threshold:10}),t.on("chosen:updated change",function(e){t.val()?$("#value-wrapper").removeClass("d-none"):$("#value-wrapper").addClass("d-none")});const r={order:[[0,"asc"]],createdRow:function(e,a,t){$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[3])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[3]+'" class="icon-name"><div class="icon"><img src="'+t[2]+'" alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")}},{targets:1,render:function(e,a,t){return t[4]},orderable:!1}]},s=$("#search-table").gdbTable({tableOptions:r,searchFields:[e,a,t,n]});$("#search button").on("click",function(e){s.draw()}),$("#apps-table").gdbTable({searchFields:[$("#app-search")]}),$("#packages-table").gdbTable({searchFields:[$("#package-search")]}),$("#apps-table tbody tr").on("click",function(t){a.val($(this).attr("data-key")).trigger("chosen:updated"),e.val("apps").trigger("chosen:updated"),$('a.nav-link[href="#search"]').tab("show"),s.draw()}),$("#packages-table tbody tr").on("click",function(t){a.val($(this).attr("data-key")).trigger("chosen:updated"),e.val("packages").trigger("chosen:updated"),$('a.nav-link[href="#search"]').tab("show"),s.draw()})}const $queuesPage=$("#queues-page");if($queuesPage.length>0||$playerMissingPage.length>0){let e=!0;$(window).on("focus",function(){e=!0}),$(window).on("blur",function(){e=!1});const a={};$("[data-queue]").each(function(e,t){a[$(this).attr("data-queue")]=loadChart($(this).attr("id"))}),updateCharts();const t=window.setInterval(updateCharts,1e4);let n=!0;function updateCharts(){e&&$.ajax({url:"/queues/queues.json",dataType:"json",cache:!1,success:function(e,t,r){$playerMissingPage.length>0&&(e={GDB_Players:e.GDB_Players}),$.each(a,function(a,t){let r=0;for(let s in e)e.hasOwnProperty(s)&&s.startsWith("GDB_"+a)&&(n?t.addSeries({name:s,data:e[s].max_messages}):t.series[r].setData(e[s].max_messages),r++)}),n=!1,$("#live-badge").addClass("badge-success").removeClass("badge-secondary badge-danger")},error:function(e,a,n){clearTimeout(t),$("#live-badge").addClass("badge-danger").removeClass("badge-secondary badge-success"),toast(!1,"Live functionality has stopped")}})}function loadChart(e){return Highcharts.chart(e,$.extend(!0,{},defaultChartOptions,{chart:{animation:!1},legend:{enabled:!1},xAxis:{labels:{step:1,formatter:function(){return moment(this.value).format("h:mm")}}},yAxis:{title:{text:""},allowDecimals:!1,min:0},plotOptions:{series:{marker:{enabled:!1},animation:!1}},series:[],tooltip:{outside:!0,shared:!0,crosshairs:!0,formatter:function(){let e="<b>"+moment(this.x).format("hh:mm")+"</b>";return $.each(this.points,function(a,t){t.y>0&&(e+="<br/>"+t.series.name.replace(/^GDB_/,"")+": "+t.y.toLocaleString())}),e}}}))}}function captchaCallback(e){$("form[data-captcha] button[type=submit]").prop("disabled",!1);const a=$("form[data-captcha] input[type=text], form input[type=email], form textarea").filter(function(){return""===$(this).val()});a.length>0&&a.get(0).focus()}const $settingsPage=$("#settings-page");if(($settingsPage.length>0||$("#signup-page").length>0)&&$("#password-container input:password").pwstrength(),$settingsPage.length>0){function loadEvents(){$("select.form-control-chosen").chosen({disable_search_threshold:5,allow_single_deselect:!0}),$("#events table.table").gdbTable({searchFields:[$("#type")],tableOptions:{order:[[0,"desc"]],columnDefs:[{targets:0,render:function(e,a,t){return'<span data-toggle="tooltip" data-placement="left" title="'+t[1]+'" data-livestamp="'+t[0]+'">'+t[1]+"</span>"},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:1,render:function(e,a,t){return'<i class="fas '+t[7]+'"></i> '+t[2]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:2,render:function(e,a,t){return t[3]===t[6]?'<span class="font-weight-bold" data-toggle="tooltip" data-placement="left" title="Your current IP">'+t[8]+"</span>":t[8]},orderable:!1},{targets:3,render:function(e,a,t){return'<span data-toggle="tooltip" data-placement="left" title="'+t[4]+'">'+t[5]+"</span>"},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1}]}})}function loadDonations(){$("#donations table.table").gdbTable({tableOptions:{order:[[0,"desc"]],columnDefs:[{targets:0,render:function(e,a,t){return'<span data-toggle="tooltip" data-placement="left" title="'+t[1]+'" data-livestamp="'+t[0]+'">'+t[1]+"</span>"},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:1,render:function(e,a,t){return"$ "+(t[2]/100).toLocaleString()},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:2,render:function(e,a,t){return t[3]},orderable:!1}]}})}$("#reset-api-key-btn").on("click",function(e){return bootbox.confirm({message:"Are you sure? Any calls using the current API key will stop wirking.",buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(e){e&&window.location.replace("/settings/new-key")}})}),$("#highlight").on("mouseenter",function(e){$(this).select(),document.execCommand("copy"),toast(!0,"API Key Copied")}),loadAjaxOnObserve({"events-table":loadEvents,"donations-table":loadDonations})}$("#sales-page").length>0&&function(e,a){"use strict";const t=e("#clock"),n=t.attr("data-time");t.countdown(n,function(a){e(this).html(a.strftime("%D:%H:%M:%S"))}),e("select.form-control-chosen").chosen({disable_search_threshold:5,allow_single_deselect:!0,max_selected_options:10});const r=e("#price-slider"),s=noUiSlider.create(r[0],{start:[0,100],connect:!0,step:1,range:{min:0,max:100}}),o=e("#score-slider"),l=noUiSlider.create(o[0],{start:[0,100],connect:!0,step:1,range:{min:0,max:100}}),i=e("#discount-slider"),c=noUiSlider.create(i[0],{start:[0,100],connect:!0,step:1,range:{min:0,max:100}}),d=e("#index-slider"),u=parseInt(d.attr("data-max")),p=noUiSlider.create(d[0],{start:u+1,connect:!0,step:1,range:{min:1,max:u+1}});function m(a){const t=s.get();t[0]===t[1]?e("label#price-label").html("Price ("+user.userCurrencySymbol+Math.round(t[0])+")"):e("label#price-label").html("Price ("+user.userCurrencySymbol+Math.round(t[0])+" to "+user.userCurrencySymbol+Math.round(t[1])+")");const n=l.get();n[0]===n[1]?e("label#score-label").html("Score ("+Math.round(n[0])+"%)"):e("label#score-label").html("Score ("+Math.round(n[0])+"% to "+Math.round(n[1])+"%)");const r=c.get();r[0]===r[1]?e("label#discount-label").html("Discount (-"+Math.round(r[0])+"%)"):e("label#discount-label").html("Discount (-"+Math.round(r[0])+"% - to -"+Math.round(r[1])+"%)"),e("label#index-label").html("Max Per Game ("+Math.trunc(p.get())+")")}window.updateLabels=m,e(m);const g={order:[[3,"desc"]],createdRow:function(a,t,n){e(a).attr("data-link",t[3]),e(a).attr("data-app-id",t[0])},columnDefs:[{targets:0,render:function(e,a,t){let n=t[1];return n=n+" <br /><small>"+t[13]+" / "+t[10]+"</small>",1===t[11]?n+=' <span class="badge badge-success float-right">Equal lowest</span>':2===t[11]&&(n+=' <span class="badge badge-success float-right">Lowest Ever!</span>'),null!=t[15]&&t[15].includes(777)&&(n+=' <span class="badge badge-success float-right">Low Confidence</span>'),'<a href="'+t[3]+'" class="icon-name"><div class="icon"><img class="tall" data-lazy="'+t[2]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+n+"</div></a>"},createdCell:function(a,t,n,r,s){e(a).addClass("img")}},{targets:1,render:function(e,a,t){return t[4]?t[4]:"-"},orderSequence:["asc","desc"]},{targets:2,render:function(e,a,t){return t[5]+"%"},orderSequence:["asc"]},{targets:3,render:function(e,a,t){return t[6]},orderSequence:["desc"]},{targets:4,render:function(e,a,t){let n='<span data-toggle="tooltip" data-placement="left" title="'+t[7]+'" data-livestamp="'+t[7]+'"></span>';return t[11]&&(n+="*"),n},createdCell:function(a,t,n,r,s){e(a).attr("nowrap","nowrap")},orderSequence:["asc"]},{targets:5,render:function(e,a,t){return t[9].startsWith("1970-01-01")?t[14]:'<span data-toggle="tooltip" data-placement="left" title="'+t[9]+'" data-livestamp="'+t[9]+'"></span>'},createdCell:function(a,t,n,r,s){e(a).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:6,render:function(e,a,t){return t[8]?'<a href="'+t[8]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1}]},h=(new URL(window.location).searchParams,e("#platforms")),f=e("#app-type"),b=[e("#search"),e("#tags-in"),e("#tags-out"),e("#categories"),e("#sale-type"),f,h,r,o,i,d];e("table.table").gdbTable({tableOptions:g,searchFields:b})}(jQuery,document);const $statPage=$("#stat-page");if($statPage.length>0){function statTable(){const e={order:[[1,"desc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[8]),$(e).attr("data-player-id",a[0])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[3]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[2]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[4].toLocaleString()},orderSequence:["desc"]},{targets:2,render:function(e,a,t){return t[5]},orderSequence:["desc"]},{targets:3,render:function(e,a,t){return t[8]},orderSequence:["desc","asc"]},{targets:4,render:function(e,a,t){return t[6]},orderSequence:["desc"]},{targets:5,render:function(e,a,t){return t[7]?'<a href="'+t[7]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1}]};$("#games").gdbTable({tableOptions:e,searchFields:[$("#items-search")]})}function statHighChart(){$.ajax({type:"GET",url:"/"+$statPage.attr("data-stat-type")+"/"+$statPage.attr("data-stat-id")+"/time.json",dataType:"json",success:function(e,a,t){null===e&&(e=[]);const n={allowDecimals:!1,title:{text:""},labels:{enabled:!1}};Highcharts.chart("stat-chart",$.extend(!0,{},defaultChartOptions,{yAxis:[n,n,n,n,n,n,n,n],tooltip:{formatter:function(){const e=moment(this.key).format("dddd DD MMM YYYY");switch(this.series.name){case"Apps":return Math.round(this.y).toLocaleString()+" games with tag on "+e;case"Apps (%)":return this.y.toLocaleString()+"% of games have tag "+e;case"Mean Players":return this.y.toLocaleString()+" mean max weakly players on "+e;case"Mean Price ("+user.userCurrencySymbol+")":return user.userCurrencySymbol+" "+(this.y/100).toFixed(2).toLocaleString()+" mean price on "+e;case"Mean Review Score":return this.y.toLocaleString()+"% mean review score on "+e;case"Median Players":return this.y.toLocaleString()+" median max weakly players on "+e;case"Median Price ("+user.userCurrencySymbol+")":return user.userCurrencySymbol+" "+(this.y/100).toFixed(2).toLocaleString()+" median price on "+e;case"Median Review Score":return this.y.toLocaleString()+"% median review score on "+e}}},series:[{name:"Apps",data:e.max_apps_count,marker:{symbol:"circle"},yAxis:0},{name:"Apps (%)",data:e.max_apps_percent,marker:{symbol:"circle"},yAxis:1},{name:"Mean Players",data:e.max_mean_players,marker:{symbol:"circle"},yAxis:2},{name:"Median Players",data:e.max_median_players,marker:{symbol:"circle"},yAxis:3,visible:!1},{name:"Mean Price ("+user.userCurrencySymbol+")",data:e["max_mean_price_"+user.prodCC],marker:{symbol:"circle"},yAxis:4},{name:"Median Price ("+user.userCurrencySymbol+")",data:e["max_median_price_"+user.prodCC],marker:{symbol:"circle"},yAxis:5,visible:!1},{name:"Mean Review Score",data:e.max_mean_score,marker:{symbol:"circle"},yAxis:6},{name:"Median Review Score",data:e.max_median_score,marker:{symbol:"circle"},yAxis:7,visible:!1}]}))}})}loadAjaxOnObserve({"stat-chart":statHighChart,games:statTable})}if($("#stats-page").length>0&&function(e,a){"use strict";loadAjaxOnObserve({"client-players":function(){e.ajax({type:"GET",url:"/stats/client-players.json",dataType:"json",success:function(a,t,n){null===a&&(a=[]),Highcharts.chart("client-players",e.extend(!0,{},defaultChartOptions,{yAxis:{allowDecimals:!1,title:{text:""}},tooltip:{formatter:function(){const e=moment(this.key).format("dddd DD MMM YYYY @ HH:mm");return"Ingame"===this.series.name?this.y.toLocaleString()+" people in a game on "+e:this.y.toLocaleString()+" people online on "+e}},series:[{name:"In Game",marker:{symbol:"circle"},data:a.max_player_count,type:"area"},{name:"Online",marker:{symbol:"circle"},data:a.max_player_online,type:"line"}]}))}})},"client-players2":function(){e.ajax({type:"GET",url:"/stats/client-players2.json",dataType:"json",success:function(a,t,n){null===a&&(a=[]),Highcharts.chart("client-players2",e.extend(!0,{},defaultChartOptions,{chart:{zoomType:"x"},yAxis:{allowDecimals:!1,title:{text:""}},tooltip:{formatter:function(){const e=moment(this.key).format("dddd DD MMM YYYY");return"In Game"===this.series.name?this.y.toLocaleString()+" people in a game on "+e:this.y.toLocaleString()+" people online on "+e}},series:[{name:"In Game",marker:{symbol:"circle"},data:a.max_player_count,type:"area"},{name:"Online",marker:{symbol:"circle"},data:a.max_player_online,type:"line"}]}))}})},scores:function(){e.ajax({type:"GET",url:"/stats/app-scores.json",dataType:"json",success:function(t,n,r){null===t&&(t=[]),Highcharts.chart("scores-chart",e.extend(!0,{},defaultChartOptions,{chart:{type:"column"},legend:{enabled:!1},xAxis:{type:"category",tickInterval:5},yAxis:{allowDecimals:!1,title:{text:""}},tooltip:{formatter:function(){return this.y.toLocaleString()+" apps have "+this.x+"/100"}},plotOptions:{series:{pointPadding:0,groupPadding:0,cursor:"pointer",point:{events:{click:function(){a.location.href="/games?score="+this.x+"&score="+(this.x+1)}}}}},series:[{data:t}]}))}})},"release-dates":function(){e.ajax({type:"GET",url:"/stats/release-dates.json",dataType:"json",success:function(a,t,n){null===a&&(a=[]),Highcharts.chart("release-dates-chart",e.extend(!0,{},defaultChartOptions,{chart:{zoomType:"x"},legend:{enabled:!1},yAxis:{allowDecimals:!1,title:{text:""}},tooltip:{formatter:function(){return this.y.toLocaleString()+" apps released on "+moment(this.key).format("dddd DD MMM YYYY")}},series:[{data:a}]}))}})},"app-types":function(){e.ajax({type:"GET",url:"/stats/app-types.json",dataType:"json",cache:!0,success:function(a,t,n){const r=e("#app-types-table tbody");r.empty(),r.json2html(a.rows,{"<>":"tr","data-link":"/games?types=${type}",html:[{"<>":"td",html:"${typef}"},{"<>":"td",html:"${countf}"},{"<>":"td",html:"${totalf}"}]},{prepend:!1}),e("#total-price").text(a.total),e("#app-types-table").gdbTable()}})},"player-countries":function(){e.ajax({type:"GET",url:"/stats/player-countries.json",dataType:"json",success:function(a,t,n){Highcharts.chart("player-countries-chart",e.extend(!0,{},defaultChartOptions,{chart:{type:"column"},legend:{enabled:!1},xAxis:{type:"category"},yAxis:{type:"logarithmic",title:null},plotOptions:{series:{pointPadding:0,groupPadding:0}},series:[{data:a.series}],drilldown:{series:a.drilldown}}))}})},"player-levels":function(){e.ajax({type:"GET",url:"/stats/player-levels.json",dataType:"json",success:function(a,t,n){let r=[],s=[];a.forEach(function(e,t,n){r.push(a[t].id),s.push(e.count)}),Highcharts.chart("player-levels-chart",e.extend(!0,{},defaultChartOptions,{chart:{type:"column"},legend:{enabled:!1},xAxis:{type:"category",tickInterval:5,categories:r,labels:{formatter:function(){return this.value.toLocaleString()}}},yAxis:{type:"logarithmic",allowDecimals:!1,title:{text:""}},tooltip:{formatter:function(){return this.y.toLocaleString()+" players are level "+this.x+"-"+(this.x+9)}},plotOptions:{series:{pointPadding:0,groupPadding:0}},series:[{data:s}]}))}})},"player-update-days":function(){e.ajax({type:"GET",url:"/stats/player-update-dates.json",dataType:"json",success:function(a,t,n){null===a&&(a=[]),Highcharts.chart("player-update-days-chart",e.extend(!0,{},defaultChartOptions,{chart:{type:"column"},legend:{enabled:!1},yAxis:{allowDecimals:!1,title:{text:""}},tooltip:{formatter:function(){return this.y.toLocaleString()+" players updated on "+moment(this.x).format("dddd DD MMM YYYY")}},plotOptions:{series:{pointPadding:0,groupPadding:0}},series:[{data:a}]}))}})}})}(jQuery,window),$("#stats-list-page").length>0&&function(e,a){"use strict";const t={order:[[1,"desc"]],createdRow:function(a,t,n){e(a).attr("data-link",t[0])},columnDefs:[{targets:0,render:function(e,a,t){return t[1]=t[1]?t[1]:"-",'<i class="fas fa-star"></i> <span class="markable">'+t[1]+"</span>"},orderSequence:["asc","desc"]},{targets:1,render:function(e,a,t){return t[2].toLocaleString()},orderSequence:["desc","asc"]},{targets:2,render:function(e,a,t){return t[6].toFixed(2).toLocaleString()+"%"},orderSequence:["desc","asc"]},{targets:3,render:function(e,a,t){return t[2]?t[3]:"-"},createdCell:function(a,t,n,r,s){e(a).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:4,render:function(e,a,t){return t[2]?t[5]:"-"},orderSequence:["desc","asc"]},{targets:5,render:function(e,a,t){return t[2]?t[4].toLocaleString():"-"},orderSequence:["desc","asc"]},{targets:6,render:function(e,a,t){return t[7]+"%"},orderSequence:["desc","asc"],visible:a.location.pathname.includes("publishers")||a.location.pathname.includes("developers")}]};e("table.table").gdbTable({tableOptions:t,searchFields:[e("#search"),e("#type")]})}(jQuery,window),$("#upcoming-page").length>0&&$("table.table").gdbTable({searchFields:[$("#search")],tableOptions:{order:[[1,"desc"]],createdRow:function(e,a,t){$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[3])},drawCallback:function(e){const a=this.api();if(a.order()[0]&&2===a.order()[0][0]){const e=a.rows({page:"current"}).nodes();let t=null;a.rows().every(function(a,n,r){let s=this.data()[6];t!==s&&($(e).eq(a).before('<tr class="table-success"><td colspan="6">'+s+"</td></tr>"),t=s)})}},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[3]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[2]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[7]},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["desc"]},{targets:2,render:function(e,a,t){return'<span data-toggle="tooltip" data-placement="left" title="'+t[10]+'" data-livestamp="'+t[9]+'"></span>'},createdCell:function(e,a,t,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["asc","desc"]},{targets:3,render:function(e,a,t){return t[8]?'<a href="'+t[8]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1}]}}),$("#wishlists-page").length>0){const e={order:[[1,"desc"]],createdRow:function(e,a,t){$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[3])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[3]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[2]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,n,r){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[4].toLocaleString()},orderSequence:["desc"]},{targets:2,render:function(e,a,t){return t[11].toLocaleString()},orderSequence:["desc"]},{targets:3,render:function(e,a,t){return t[5].toLocaleString()},orderSequence:["asc","desc"]},{targets:4,render:function(e,a,t){return t[6]},orderSequence:["desc","asc"]},{targets:5,render:function(e,a,t){return t[10]},orderSequence:["desc","asc"]},{targets:6,render:function(e,a,t){return t[9]},orderSequence:["asc","desc"]},{targets:7,render:function(e,a,t){return t[7]?'<a href="'+t[7]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1}]};$("#apps table.table").gdbTable({tableOptions:e,searchFields:[$("#search")]});const a={pageLength:1e3,order:[[1,"desc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[2])},columnDefs:[{targets:0,render:function(e,a,t){return'<i class="fas fa-tag"></i> '+t[1]}},{targets:1,render:function(e,a,t){return t[3].toLocaleString()}}]};$("#tags table.table").gdbTable({tableOptions:a})}